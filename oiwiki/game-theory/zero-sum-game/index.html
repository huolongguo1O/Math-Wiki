
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Zero sum game - Math-wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Math-wiki" class="md-header__button md-logo" aria-label="Math-wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Math-wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Zero sum game
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  简介

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ineq/" class="md-tabs__link">
          
  
  
  不等式

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../number-theory/basic/" class="md-tabs__link">
          
  
  
  数论

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../complex/" class="md-tabs__link">
          
  
  
  杂项

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Math-wiki" class="md-nav__button md-logo" aria-label="Math-wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Math-wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    简介
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    不等式
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    不等式
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    最最最基本的不等关系
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../am-gm.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    均值不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    数论
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    数论
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    基础知识
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/mod-arithmetic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    模运算
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/prime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    质数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/gcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    最大公约数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/bezouts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bezout定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/inverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    逆元
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/crt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    中国剩余定理（CRT）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/euler-function.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    欧拉函数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/fermat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    费马小定理与欧拉定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/primitive-root/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    阶与原根
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/congruence-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    同余方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/linear-congruence-equation.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    线性同余方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/quadratic-residue.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    二次剩余
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/pell-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pell方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/mobius/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    莫比乌斯反演
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/lifting-the-exponent.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LTE引理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/quadratic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    二次域
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    杂项
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    杂项
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../complex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    复数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        序贯零和游戏
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="序贯零和游戏">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        例题
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        习题
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        同时零和游戏
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="同时零和游戏">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        混合策略
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#von-neumann" class="md-nav__link">
    <span class="md-ellipsis">
      
        von Neumann 定理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        转化为线性规划问题
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        习题
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        参考资料与注释
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Zero sum game</h1>

<p>前置知识：<a href="../intro/">博弈论简介</a></p>
<p>本文讨论（二人）<a href="../intro/#零和非零和博弈">零和游戏</a>．</p>
<p>在零和游戏中，两名玩家的收益之和恒为零，一方的收益必然意味着另一方的损失．零和游戏可以视为常和游戏的特殊情形．不过，任何常和游戏都可以通过对某一方的收益整体加上或减去一个常数，等价地转化为零和游戏，所以仅需要讨论零和游戏．</p>
<p>在算法竞赛中常见的零和游戏大致可分为两类：序贯零和游戏与同时零和游戏．</p>
<h2 id="_1">序贯零和游戏</h2>
<p>序贯零和游戏中，两名玩家轮流行动，直到游戏终止．</p>
<p>序贯零和游戏中，玩家的收益函数呈现递归结构．游戏局面 <span class="arithmatex">\(S\)</span> 可以分为三类，即终止局面 <span class="arithmatex">\(S_0\)</span>、玩家 <span class="arithmatex">\(1\)</span> 行动的局面 <span class="arithmatex">\(S_1\)</span> 和玩家 <span class="arithmatex">\(2\)</span> 行动的局面 <span class="arithmatex">\(S_2\)</span>．假设终止局面 <span class="arithmatex">\(s\in S_0\)</span> 处，玩家 <span class="arithmatex">\(1\)</span> 的收益为 <span class="arithmatex">\(v(s)\)</span>，相应地，玩家 <span class="arithmatex">\(2\)</span> 的收益为 <span class="arithmatex">\(-v(s)\)</span>．因此，轮到玩家 <span class="arithmatex">\(2\)</span> 行动时，最大化它的收益就相当于最小化玩家 <span class="arithmatex">\(1\)</span> 的收益．由此，假设双方都采取最优策略，玩家 <span class="arithmatex">\(1\)</span> 在局面 <span class="arithmatex">\(s\in S\)</span> 处能够获得的最大收益 <span class="arithmatex">\(V(s)\)</span> 满足如下递推关系：</p>
<div class="arithmatex">\[
V(s) = \begin{cases}
v(s), &amp; s \in S_0,\\
\max_{t\in s} V(t), &amp; s\in S_1,\\
\min_{t\in s} V(t), &amp; s\in S_2.
\end{cases}
\]</div>
<p>其中，<span class="arithmatex">\(t\in s\)</span> 表示 <span class="arithmatex">\(t\)</span> 是 <span class="arithmatex">\(s\)</span> 的后继局面．这就是 <a href="../../search/alpha-beta.md#minimax-算法">极小化极大思想</a>．</p>
<p>将这一算法应用于实际问题中，通常有如下具体方法：</p>
<ul>
<li>
<p>如果游戏中涉及的局面数量较少，直接暴力实现这一算法即可．</p>
</li>
<li>
<p>如果游戏中涉及的局面数量较为庞大且没有特殊结构，可以考虑 <a href="../../search/alpha-beta.md#alphabeta-剪枝">Alpha–Beta 剪枝</a> 并结合其他搜索剪枝算法使用．</p>
</li>
<li>
<p>如果游戏中单个局面经常是多个局面的后继局面，为避免重复搜索，可以考虑记忆化搜索或其他动态规划算法．</p>
</li>
<li>
<p>如果游戏中玩家的最终收益是终局前所有行动的收益和，可以适当优化建模方式．具体地，假设到达终局 <span class="arithmatex">\(s\in S_0\)</span> 时，玩家 <span class="arithmatex">\(i=1,2\)</span> 的行动序列分别为 <span class="arithmatex">\(\{a^{(i)}_j\}_{j=1}^{k_i}\)</span>，行动 <span class="arithmatex">\(a\)</span> 对应的收益为 <span class="arithmatex">\(w(a)\)</span>，玩家 <span class="arithmatex">\(1\)</span> 的收益函数为</p>
<div class="arithmatex">\[
v(s) = \sum_{j=1}^{k_1}w(a_j^{(1)}) - \sum_{j=1}^{k_2}w(a_j^{(2)}).
\]</div>
<p>那么，可以设 <span class="arithmatex">\(\tilde V(s)\)</span> 为当前玩家在局面 <span class="arithmatex">\(s\in S\)</span> 之后的游戏中能够取得的最大分数．对于初始状态 <span class="arithmatex">\(s_0\)</span>，有 <span class="arithmatex">\(V(s_0)=\tilde V(s_0)\)</span>，因此求出 <span class="arithmatex">\(\tilde V(\cdot)\)</span> 足以求解原问题．对于 <span class="arithmatex">\(\tilde V(\cdot)\)</span>，有如下递推关系：</p>
<div class="arithmatex">\[
\tilde V(s) = \begin{cases}
0, &amp; s \in S_0, \\
\max_{t\in s} w(a_{s\to t}) - \tilde V(t), &amp; s\in S_1\cup S_2.
\end{cases}
\]</div>
<p>其中，<span class="arithmatex">\(a_{s\to t}\)</span> 表示可以使得状态从 <span class="arithmatex">\(s\)</span> 转移到 <span class="arithmatex">\(t\)</span> 的行动，如果有多个这样的行动，取收益 <span class="arithmatex">\(w(a)\)</span> 最高的那个．</p>
</li>
<li>
<p>公平组合游戏都是序贯零和游戏，只需要设游戏中胜利方和失败方的收益分别为 <span class="arithmatex">\(+1\)</span> 和 <span class="arithmatex">\(-1\)</span>．此时，收益函数 <span class="arithmatex">\(V(\cdot)\)</span> 的递推关系其实就是判定必胜状态和必败状态的 <a href="../impartial-game/#博弈图和状态">引理</a>．</p>
<p>这类问题还有一种常见的变形，即求胜利方最少需要的回合数和失败方最多可以坚持的回合数．为此，只需要注意到从终止状态开始做 BFS 并按照引理判定必胜状态和必败状态时，记录判定必胜状态和必败状态时 BFS 进行到的轮次数，就是所求的回合数．这是因为判定为必胜状态只需要一个后继状态是必败状态即可，它总是由后继状态中轮次数最小的必败状态转移而来；而判定为必败状态需要所有后继状态都是必胜状态，它总是由后继状态中轮次数最大的必胜状态转移而来．</p>
<p>这一方法同样可以推广到一般的 <a href="../impartial-game/#有向图游戏">有向图游戏</a>．</p>
</li>
</ul>
<h3 id="_2">例题</h3>
<p>???+ example "<a href="https://codeforces.com/problemset/problem/794/E">Codeforces 794 E. Choosing Carrot</a>"
    设有一个长度为 <span class="arithmatex">\(n\)</span> 的数列 <span class="arithmatex">\({a_i}\)</span>．两名玩家 <span class="arithmatex">\(1\)</span> 和 <span class="arithmatex">\(2\)</span> 轮流从数列的两端取走一个数，直到数列中仅剩下最后一个数字为止．玩家 <span class="arithmatex">\(1\)</span> 的目标是最大化这个最后剩下的数字，玩家 <span class="arithmatex">\(2\)</span> 的目标是最小化它．在游戏正式开始前，玩家 <span class="arithmatex">\(1\)</span> 还可以先进行 <span class="arithmatex">\(k\)</span> 次行动．假设两名玩家在整个过程中都采取最优策略．对于每一个 <span class="arithmatex">\(k = 0,1,2,\cdots,n-1\)</span>，求出游戏结束时最后剩下的数字．其中，<span class="arithmatex">\(1 \le n \le 3\times 10^5\)</span>．</p>
<p>??? note "解答"
    因为无论双方怎样取走数字，数列剩余部分都是一段完整的区间．所以，游戏中的局面可以仅由区间 <span class="arithmatex">\([l,r]\)</span> 和当前行动的玩家 <span class="arithmatex">\(i=1,2\)</span> 描述，可以使用动态规划算法求解．设 <span class="arithmatex">\(f(l,r,i)\)</span> 为局面由 <span class="arithmatex">\((l,r,i)\)</span> 描述时，游戏最后剩下的数字．由前文分析可知，当 <span class="arithmatex">\(l &lt; r\)</span> 时，这一函数满足状态转移方程：</p>
<pre><code>$$
\begin{aligned}
f(l,r,1) &amp;= \max\{f(l+1,r,2),f(l,r-1,2)\},\\
f(l,r,2) &amp;= \min\{f(l+1,r,1),f(l,r-1,1)\}.
\end{aligned}
$$

终值条件为 $f(l,l,1)=f(l,l,2) = a_l$．据此，可以在 $\Theta(n^2)$ 时间内求出所有可能局面的函数值．对于每个 $k$，答案就是

$$
g(k) = \max f(l,r,1) \text{ subject to } r - l + 1 = k.
$$

这一算法无法通过原题所设的数据范围，因此需要考虑优化转移．此处有很多种处理方法，本文只提供其中一种．

将状态转移方程看作是对数列整体的操作．两个转移方程分别表示将相邻数字取最大值和最小值得到新数列，将它们分别称为「最大化操作」和「最小化操作」．每次操作都会使得数列长度减一．所有长度为 $d$ 的区间对应结果共计 $(n-d+1)$ 个，这就相当于对序列进行 $(d-1)$ 次操作得到的序列．另外，要得到 $f(l,r,1)$ 的结果，就需要保证最后一次操作是最大化操作．因此，这些操作序列的结尾总是最大化操作．

考虑连续两次操作给数列带来的变化．不妨考虑首先做最小化操作，再做最大化操作．此时，数列 $a_1,a_2,a_3$ 将变为

$$
\max\{\min\{a_1,a_2\},\min\{a_2,a_3\}\}.
$$

枚举 $a_1,a_2,a_3$ 三个数字之间所有可能的大小关系可知，除了 $a_1 &lt; a_2$ 且 $a_2 &gt; a_3$（即 $a_2$ 是严格极大值）这种情形外，这一表达式总是等于 $a_2$．也就是说，如果一个数列不存在任何严格极大值点，那么，连续两次操作对它的唯一影响就是删去了数列首尾各一个数字．这显然大幅简化了转移．剩下唯一的问题就是：如何保证数列不存在任何严格极大值点？事实上，只要对序列做一次最大化操作，就能保证不存在严格极大值点．故而，所有偶数次操作的结果，可以通过对初始数列进行两次操作得到的序列，逐对删去首尾数字得到；所有奇数次操作的结果，可以通过对初始数列进行一次操作得到的序列，逐对删去首尾数字得到．

由于对序列的完整操作至多只需要进行 $3$ 次，而后续统计答案只需要 $2$ 次遍历，所以该算法的总时间复杂度为 $\Theta(n)$．
</code></pre>
<p>??? note "参考代码"
    <code>cpp
    --8&lt;-- "docs/math/code/zero-sum-game/zero-sum-game-1.cpp"</code></p>
<h3 id="_3">习题</h3>
<ul>
<li><a href="https://www.luogu.com.cn/problem/P2734">Luogu P2734 [USACO3.3] 游戏 A Game</a></li>
<li><a href="https://www.luogu.com.cn/problem/P4576">Luogu P4576 [CQOI2013] 棋盘游戏</a></li>
<li><a href="https://www.luogu.com.cn/problem/P7097">Luogu P7097 [yLOI2020] 牵丝戏</a></li>
<li><a href="https://codeforces.com/problemset/problem/388/C">Codeforces 388 C. Fox and Card Game</a></li>
<li><a href="https://codeforces.com/problemset/problem/794/E">Codeforces 794 E. Choosing Carrot</a></li>
<li><a href="https://codeforces.com/problemset/problem/1628/D2">Codeforces 1628 D2. Game on Sum (Hard Version)</a></li>
<li><a href="https://www.luogu.com.cn/problem/P3210">Luogu P3210 [HNOI2010] 取石头游戏</a></li>
</ul>
<h2 id="_4">同时零和游戏</h2>
<p>同时零和博弈中，两名玩家同时行动．</p>
<p>同时零和游戏通常采用收益矩阵表示．假设玩家 <span class="arithmatex">\(i=1,2\)</span> 的行动集合为 <span class="arithmatex">\(A_i\)</span>，且当玩家 <span class="arithmatex">\(i=1,2\)</span> 分别采取行动 <span class="arithmatex">\(a_i\in A_i\)</span> 时，两人的收益分别是 <span class="arithmatex">\(v(a_1,a_2)\)</span> 和 <span class="arithmatex">\(-v(a_1,a_2)\)</span>．</p>
<p>???+ example "例子"
    考虑石头剪刀布游戏．假定胜利得 <span class="arithmatex">\(1\)</span> 分，失败得 <span class="arithmatex">\(-1\)</span> 分，平局得 <span class="arithmatex">\(0\)</span> 分．那么，游戏中两人的收益可以表示为</p>
<pre><code>$$
\begin{pmatrix}
0,0 &amp; 1,-1 &amp; -1,1 \\
-1,1 &amp; 0,0 &amp; 1,-1 \\
1,-1 &amp; -1,1 &amp; 0,0
\end{pmatrix}.
$$

一般的二人同时游戏也可以表示为类似形式，故而也称为 [双矩阵游戏](https://en.wikipedia.org/wiki/Bimatrix_game)（bimatrix game）．对于零和博弈，由于玩家 $1$ 的收益矩阵和玩家 $2$ 的收益矩阵互为相反数，所以可以只考虑玩家 $1$ 的收益矩阵：

$$
V = (v(a_1,a_2))_{(a_1,a_2)\in A_1\times A_2} = \begin{pmatrix}
0 &amp; 1 &amp; -1 \\
-1 &amp; 0 &amp; 1 \\
1 &amp; -1 &amp; 0
\end{pmatrix}.
$$
</code></pre>
<p>需要解决的问题是：给定收益矩阵 <span class="arithmatex">\(V = (v(a_1,a_2))_{(a_1,a_2)\in A_1\times A_2}\)</span>，如何求出两名玩家的最优策略和最大收益？</p>
<h3 id="_5">混合策略</h3>
<p>相较于序贯零和游戏，同时游戏中两名玩家的角色是对称的．但是，既然已经解决了序贯零和游戏，那么不妨考虑同时游戏的序贯版本．例如，如果假定玩家 <span class="arithmatex">\(1\)</span> 首先做出行动，玩家 <span class="arithmatex">\(2\)</span> 再做出行动，那么，根据前文讨论，游戏结束时玩家 <span class="arithmatex">\(1\)</span> 的收益将由</p>
<div class="arithmatex">\[
w_-=\max_{a_1\in A_1}\min_{a_2\in A_2} v(a_1,a_2)
\]</div>
<p>给出．由于玩家 <span class="arithmatex">\(1\)</span> 的行动对于玩家 <span class="arithmatex">\(2\)</span> 单向透明，这应该是玩家 <span class="arithmatex">\(1\)</span> 所能获得的最差结果．对称地，如果假定玩家 <span class="arithmatex">\(2\)</span> 首先行动，那么，玩家 <span class="arithmatex">\(1\)</span> 的收益将由</p>
<div class="arithmatex">\[
w_+ = \min_{a_2\in A_2}\max_{a_1\in A_1} v(a_1,a_2)
\]</div>
<p>给出．由于玩家 <span class="arithmatex">\(2\)</span> 的行动对于玩家 <span class="arithmatex">\(1\)</span> 单向透明，这应该是玩家 <span class="arithmatex">\(1\)</span> 所能获得的最好结果．玩家 <span class="arithmatex">\(1\)</span> 应该期待实际进行游戏时，所能获得的收益 <span class="arithmatex">\(w\in[w_-,w_+]\)</span>．尽管不等式 <span class="arithmatex">\(w_-\le w_+\)</span> 总是成立（证明参见 <a href="../../linear-programming/#对偶原理">弱对偶定理</a>），但是由于等号未必成立，所以，仅采用序贯游戏的分析手段，一般情况下没有办法唯一确定游戏结果．</p>
<p>???+ example "例子（续）"
    石头剪刀布游戏中，如果出手有先后，那么先手必输，后手必赢．转换为数学语言，这就是下列不等式：</p>
<pre><code>$$
w_- = -1 \le +1 = w_+.
$$

此时，$w_-\neq w_+$ 并不成立．
</code></pre>
<p>上述分析过程遗漏了同时游戏的一个关键因素，就是玩家无法准确预测对手的行动．形式上，这意味着双方可以采取某种随机策略．这一想法在序贯博弈的语境下并不成立，因为无论先手玩家如何随机选择行动，后手玩家总能准确地观测到这一行动，并有针对性地回应．但是，对于同时游戏，随机策略引入的战略模糊将使得对手无法有效地针对己方的行动．</p>
<p>???+ example "例子（续）"
    石头剪刀布游戏中，如果玩家 <span class="arithmatex">\(1\)</span> 均匀随机地选择剪刀、石头、布三个行动之一，那么，根据玩家 <span class="arithmatex">\(2\)</span> 的行动不同，玩家 <span class="arithmatex">\(1\)</span> 可能获得的收益是</p>
<pre><code>$$
\dfrac{1}{3}(0,1,-1)^T + \dfrac{1}{3}(-1,0,1)^T + \dfrac{1}{3}(1,-1,0)^T = (0,0,0)^T.
$$

此时，无论玩家 $2$ 如何选择行动，玩家 $1$ 的期望收益总是 $0$．这显然好于确定性地选择单个行动．
</code></pre>
<p>由此，就引入了混合策略的概念．</p>
<p>???+ abstract "混合策略"
    同时游戏中，玩家 <span class="arithmatex">\(i\)</span> 的 <strong>混合策略</strong>（mixed strategy），简称 <strong>策略</strong>，是指函数 <span class="arithmatex">\(s_i:A_i\to[0,1]\)</span>，且它满足 <span class="arithmatex">\(\sum_{a_i\in A_i}s_i(a_i)=1\)</span>．也就是说，策略 <span class="arithmatex">\(s_i\)</span> 就是玩家 <span class="arithmatex">\(i\)</span> 的行动集合 <span class="arithmatex">\(A_i\)</span> 上的一个概率分布．玩家 <span class="arithmatex">\(i\)</span> 全体混合策略的集合记作 <span class="arithmatex">\(S_i=\Delta(A_i)\)</span>，其中，<span class="arithmatex">\(\Delta(A_i)\)</span> 表示 <span class="arithmatex">\(A_i\)</span> 上的全体概率分布的集合．如果 <span class="arithmatex">\(s_i\)</span> 是退化的概率分布，即存在 <span class="arithmatex">\(a\in A_i\)</span> 使得 <span class="arithmatex">\(s_i(a)=1\)</span>，那么，也称策略 <span class="arithmatex">\(s_i\)</span> 为 <strong>纯策略</strong>（pure strategy）．</p>
<p>混合策略的收益就是单个行动收益的期望：</p>
<div class="arithmatex">\[
v(s_1,s_2) = \sum_{a_1\in A_1}\sum_{a_2\in A_2}s_1(a_1)s_2(a_2)v(a_1,a_2).
\]</div>
<p>将单个行动看作对应的纯策略，那么，就可以将行动集合 <span class="arithmatex">\(A_i\)</span> 嵌入（混合）策略集合 <span class="arithmatex">\(S_i\)</span> 中，且上式定义的 <span class="arithmatex">\(v(s_1,s_2)\)</span> 就可以看作是将 <span class="arithmatex">\(v(a_1,a_2)\)</span> 从 <span class="arithmatex">\(A_1\times A_2\)</span> 延拓到 <span class="arithmatex">\(S_1\times S_2\)</span> 上．</p>
<h3 id="von-neumann">von Neumann 定理</h3>
<p>引入混合策略后，极大化极小思想和极小化极大思想得到的结果是一致的，由此，同时零和游戏的结果也是唯一确定的．</p>
<p>???+ note "定理（von Neumann）"
    允许混合策略的同时零和游戏中，如果双方都采取最优策略，那么，玩家 <span class="arithmatex">\(1\)</span> 的最大收益为</p>
<pre><code>$$
w = \max_{s_1\in S_1}\min_{s_2\in S_2} v(s_1,s_2) = \min_{s_2\in S_2}\max_{s_1\in S_1} v(s_1,s_2),
$$

玩家 $2$ 的最大收益为 $-w$．
</code></pre>
<p>??? note "证明"
    设 <span class="arithmatex">\(w = \max_{s_1\in S_1}\min_{s_2\in S_2} v(s_1,s_2)\)</span>．考虑内层最小化问题，因为 <span class="arithmatex">\(v(s_1,s_2)=\sum_{a_2\in A_2}s_2(a_2)v(s_1,a_2)\)</span>，所以，<span class="arithmatex">\(\max_{s_2\in S_2}v(s_1,s_2)=\max_{a_2\in A_2}v(s_1,a_2)\)</span>，前者的最优解就是后者的最优解对应的纯策略．因此，有 <span class="arithmatex">\(w = \max_{s_1\in S_1}\min_{a_2\in A_2} v(s_1,a_2)\)</span>．进而，引入辅助变量 <span class="arithmatex">\(u\)</span>，问题就可以改写为</p>
<pre><code>$$
w = \max_{s_1\in S_1} u \text{ subject to }u \le \min_{a_2\in A_2} v(s_1,a_2).
$$

因为这个约束就等价于 $u\le v(s_1,a_2)$ 对于所有 $a_2\in A_2$ 都成立．最后，引入混合策略 $s_1$ 的定义和收益函数 $v(s_1,a_2)$ 的表达式，原问题就等价于 [线性规划问题](../linear-programming.md)

$$
(P) \qquad
\begin{aligned}
w = \max_{u,s_1}\; &amp; u\\
\text{subject to }&amp; \sum_{a_1\in A_1}s_1(a_1)v(a_1,a_2) \ge u,~\forall a_2\in A_2,\\
&amp; \sum_{a_1\in A_1}s_1(a_1) = 1,\\
&amp; s_1(a_1) \ge 0,~\forall a_1\in A_1.
\end{aligned}
$$

这个问题显然是可行的，且最优解有解．根据 [对偶原理](../linear-programming.md#对偶原理) 可知，它的最优解就等于对偶问题的最优解：

$$
(D) \qquad
\begin{aligned}
w = \min_{t,s_2}\; &amp; t\\
\text{subject to }&amp;\sum_{a_2\in A_2}s_2(a_2)v(a_1,a_2) \le t,~\forall a_1\in A_1,\\
&amp;\sum_{a_2\in A_2}s_2(a_2) = 1,\\
&amp;s_2(a_2)\ge 0,~\forall a_2\in A_2.
\end{aligned}
$$

重复前文的步骤，这一问题就等价于 $\min_{s_2\in A_2}\min_{s_1\in S_1}v(s_1,s_2)$．定理得证．
</code></pre>
<p>这一结果正是这一游戏的 <a href="https://en.wikipedia.org/wiki/Nash_equilibrium">Nash 均衡</a>．也就是说，假定双方都选择均衡中的最优策略，那么，没有任何玩家能够从偏离均衡策略中严格获益．</p>
<h3 id="_6">转化为线性规划问题</h3>
<p>von Neumann 定理的证明同时也指出了同时零和游戏的求解方法．设 <span class="arithmatex">\(n\)</span> 和 <span class="arithmatex">\(m\)</span> 分别是玩家 <span class="arithmatex">\(1\)</span> 和 <span class="arithmatex">\(2\)</span> 可采取的行动数目．给定玩家 <span class="arithmatex">\(1\)</span> 的收益矩阵 <span class="arithmatex">\(V\in\mathbf R^{n\times m}\)</span>，可以求解如下线性规划问题：</p>
<div class="arithmatex">\[
\begin{aligned}
w = \max_{(u,s)\in\mathbf R\times\mathbf R^n}\; &amp; u\\
\text{subject to }&amp; V^Ts \ge u\mathbf 1,\\
&amp; \mathbf 1^Ts = 1,\\
&amp; s \ge 0.
\end{aligned}
\]</div>
<p>这是一个规模为 <span class="arithmatex">\(\Theta(n+m)\)</span> 的线性规划问题，可以用 <a href="../../simplex/">单纯形法</a> 高效求解．算法得到的最优解 <span class="arithmatex">\(s\)</span> 就是玩家 <span class="arithmatex">\(1\)</span> 的最优（混合）策略．要求得玩家 <span class="arithmatex">\(2\)</span> 的最优策略，只需要从单纯形表中获得该问题最优解的对偶变量（即影子价格）即可．</p>
<h3 id="_7">习题</h3>
<ul>
<li><a href="https://www.luogu.com.cn/problem/P4232">Luogu P4232 无意识之外的捉迷藏</a></li>
</ul>
<h2 id="_8">参考资料与注释</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Zero-sum_game">Zero-sum game - Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Minimax_theorem">Minimax theorem - Wikipedia</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>