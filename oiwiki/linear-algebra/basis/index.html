
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="cesonic, Enter-tainer, Great-designer, Ir1d, ksyx, lychees, MegaOwIer, RUIN-RISE, wjy-yy, rsdbkhusky, ouuan, Menci, Tiphereth-A">
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Basis - Math-wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#定义" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Math-wiki" class="md-header__button md-logo" aria-label="Math-wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Math-wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Basis
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  简介

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ineq/" class="md-tabs__link">
          
  
  
  不等式

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../number-theory/basic/" class="md-tabs__link">
          
  
  
  数论

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../combinatorics/combination/" class="md-tabs__link">
          
  
  
  组合数学

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../complex/" class="md-tabs__link">
          
  
  
  杂项

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Math-wiki" class="md-nav__button md-logo" aria-label="Math-wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Math-wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    简介
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    不等式
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    不等式
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    最最最基本的不等关系
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/am-gm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    均值不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/cauchy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    柯西不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/derivative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    求导法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/jensen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    琴生不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/karamata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Karamata不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/smoothing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    调整法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/rearrangement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    排列不等式与切比雪夫不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/schur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    schur不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/minkowski/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    闵可夫斯基不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    恒等变形
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    恒等变形
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/abel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    abel变换
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    数论
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    数论
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    基础知识
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/bezouts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bezout定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/inverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    逆元
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/crt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    中国剩余定理（CRT）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/euler-totient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    欧拉函数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/fermat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    费马小定理与欧拉定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/primitive-root/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    阶与原根
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/congruence-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    同余方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/prime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    有关素数的更深入的研究
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/quad-residue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    二次剩余
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/pell-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pell方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/mobius/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    莫比乌斯反演
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/lift-the-exponent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LTE引理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../number-theory/quadratic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    二次域
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    组合数学
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    组合数学
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../combinatorics/combination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    排列组合
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../combinatorics/drawer-principle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    抽屉原理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../combinatorics/inclusion-exclusion-principle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    容斥原理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../combinatorics/fibonacci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    斐波那契数列
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../combinatorics/catalan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    卡特兰数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../combinatorics/bernoulli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    伯努利数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../combinatorics/stirling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stirling数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../poly/ogf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    普通生成函数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../poly/egf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    指数生成函数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    杂项
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    杂项
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../complex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    复数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#定义" class="md-nav__link">
    <span class="md-ellipsis">
      
        定义
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#性质" class="md-nav__link">
    <span class="md-ellipsis">
      
        性质
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#例子" class="md-nav__link">
    <span class="md-ellipsis">
      
        例子
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#正交基与单位正交基" class="md-nav__link">
    <span class="md-ellipsis">
      
        正交基与单位正交基
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#应用" class="md-nav__link">
    <span class="md-ellipsis">
      
        应用
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="应用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#构造方法" class="md-nav__link">
    <span class="md-ellipsis">
      
        构造方法
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="构造方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#贪心法" class="md-nav__link">
    <span class="md-ellipsis">
      
        贪心法
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#高斯消元法" class="md-nav__link">
    <span class="md-ellipsis">
      
        高斯消元法
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#性质_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        性质
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#时间复杂度" class="md-nav__link">
    <span class="md-ellipsis">
      
        时间复杂度
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#线性基合并" class="md-nav__link">
    <span class="md-ellipsis">
      
        线性基合并
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#线性基求交" class="md-nav__link">
    <span class="md-ellipsis">
      
        线性基求交
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="线性基求交">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#朴素算法" class="md-nav__link">
    <span class="md-ellipsis">
      
        朴素算法
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zassenhaus-算法" class="md-nav__link">
    <span class="md-ellipsis">
      
        Zassenhaus 算法
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#拓展前缀线性基" class="md-nav__link">
    <span class="md-ellipsis">
      
        拓展：前缀线性基
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#练习题" class="md-nav__link">
    <span class="md-ellipsis">
      
        练习题
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#参考资料与注释" class="md-nav__link">
    <span class="md-ellipsis">
      
        参考资料与注释
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Basis</h1>

<p>回想高中数学立体几何中基向量的概念，我们可以在三维欧氏空间中找到一组基向量 <span class="arithmatex">\(\boldsymbol{i}\)</span>，<span class="arithmatex">\(\boldsymbol{j}\)</span>，<span class="arithmatex">\(\boldsymbol{k}\)</span>，之后空间中任意一个向量都可以由这组基向量表示。换句话说，我们可以 <strong>通过有限的基向量来描述无限的三维空间</strong>，这足以体现基向量的重要性。</p>
<p>三维欧氏空间是特殊的 <a href="../vector-space/">线性空间</a>，三维欧氏空间的基向量在线性空间中就被推广为了线性基。</p>
<p>OI 中有关线性基的应用一般只涉及两类线性空间：<span class="arithmatex">\(n\)</span> 维实线性空间 <span class="arithmatex">\(\mathbf{R}^n\)</span> 和 <span class="arithmatex">\(n\)</span> 维 <a href="https://en.wikipedia.org/wiki/Boolean_domain">布尔域</a> 线性空间 <span class="arithmatex">\(\mathbf{Z}_2^n\)</span>，我们会在 <a href="#应用">应用</a> 一节中详细介绍。若您不熟悉线性代数，则推荐从应用部分开始阅读。</p>
<p>以下会从一般的线性空间出发来介绍线性基，并给出线性基的常见性质。</p>
<p>前置知识：<a href="../vector-space/">线性空间</a>。</p>
<p>线性基是线性空间的一组基，是研究线性空间的重要工具。</p>
<h2 id="定义">定义<a class="headerlink" href="#定义" title="Permanent link"></a></h2>
<p>称线性空间 <span class="arithmatex">\(V\)</span> 的一个极大线性无关组为 <span class="arithmatex">\(V\)</span> 的一组 <strong>Hamel 基</strong> 或 <strong>线性基</strong>，简称 <strong>基</strong>。</p>
<p>规定线性空间 <span class="arithmatex">\(\{\theta\}\)</span> 的基为空集。</p>
<p>可以证明任意线性空间均存在线性基<sup id="fnref:existence_basis"><a class="footnote-ref" href="#fn:existence_basis">1</a></sup>，我们定义线性空间 <span class="arithmatex">\(V\)</span> 的 <strong>维数</strong> 为线性基的元素个数（或势），记作 <span class="arithmatex">\(\dim V\)</span>。</p>
<h2 id="性质">性质<a class="headerlink" href="#性质" title="Permanent link"></a></h2>
<ol>
<li>
<p>对于有限维线性空间 <span class="arithmatex">\(V\)</span>, 设其维数为 <span class="arithmatex">\(n\)</span>, 则：</p>
<ol>
<li>
<p><span class="arithmatex">\(V\)</span> 中的任意 <span class="arithmatex">\(n+1\)</span> 个向量线性相关。</p>
</li>
<li>
<p><span class="arithmatex">\(V\)</span> 中的任意 <span class="arithmatex">\(n\)</span> 个线性无关的向量均为 <span class="arithmatex">\(V\)</span> 的基。</p>
</li>
<li>
<p>若 <span class="arithmatex">\(V\)</span> 中的任意向量均可被向量组 <span class="arithmatex">\(a_1,a_2,\dots,a_n\)</span> 线性表出，则其是 <span class="arithmatex">\(V\)</span> 的一个基。</p>
<details class="note" open="open">
<summary>证明</summary>
<p>任取 <span class="arithmatex">\(V\)</span> 中的一组基 <span class="arithmatex">\(b_1,b_2,\dots,b_n\)</span>, 由已知条件，向量组 <span class="arithmatex">\(b_1,b_2,\dots,b_n\)</span> 可被 <span class="arithmatex">\(a_1,a_2,\dots,a_n\)</span> 线性表出，故</p>
<div class="arithmatex">\[
n=\operatorname{rank}\{b_1,b_2,\dots,b_n\}\leq\operatorname{rank}\{a_1,a_2,\dots,a_n\}\leq n
\]</div>
<p>因此 <span class="arithmatex">\(\operatorname{rank}\{a_1,a_2,\dots,a_n\}=n\)</span></p>
</details>
</li>
<li>
<p><span class="arithmatex">\(V\)</span> 中任意线性无关向量组 <span class="arithmatex">\(a_1,a_2,\dots,a_m\)</span> 均可通过插入一些向量使得其变为 <span class="arithmatex">\(V\)</span> 的一个基。</p>
</li>
</ol>
</li>
<li>
<p>（子空间维数公式）令 <span class="arithmatex">\(V_1,V_2\)</span> 是关于 <span class="arithmatex">\(\Bbb{P}\)</span> 的有限维线性空间，且 <span class="arithmatex">\(V_1+V_2\)</span> 和 <span class="arithmatex">\(V_1\cap V_2\)</span> 也是有限维的，则 <span class="arithmatex">\(\dim V_1+\dim V_2=\dim(V_1+V_2)+\dim(V_1\cap V_2)\)</span></p>
<details class="note" open="open">
<summary>证明</summary>
<p>设 <span class="arithmatex">\(\dim V_1=n_1\)</span>,<span class="arithmatex">\(\dim V_2=n_2\)</span>,<span class="arithmatex">\(\dim(V_1\cap V_2)=m\)</span>.</p>
<p>取 <span class="arithmatex">\(V_1\cap V_2\)</span> 的一组基 <span class="arithmatex">\(a_1,a_2,\dots,a_m\)</span>, 将其分别扩充为 <span class="arithmatex">\(V_1\)</span> 和 <span class="arithmatex">\(V_2\)</span> 中的基：<span class="arithmatex">\(a_1,a_2,\dots,a_m,b_1,b_2,\dots,b_{n_1-m}\)</span> 和 <span class="arithmatex">\(a_1,a_2,\dots,a_m,c_1,c_2,\dots,c_{n_2-m}\)</span>.</p>
<p>接下来只需证明向量组 <span class="arithmatex">\(a_1,a_2,\dots,a_m,b_1,b_2,\dots,b_{n_1-m},c_1,c_2,\dots,c_{n_2-m}\)</span> 线性无关即可。</p>
<p>设 <span class="arithmatex">\(\sum_{i=1}^m r_ia_i+\sum_{i=1}^{n_1-m} s_ib_i+\sum_{i=1}^{n_2-m} t_ic_i=\theta\)</span>.</p>
<p>则 <span class="arithmatex">\(\sum_{i=1}^{n_2-m} t_ic_i=-\sum_{i=1}^m r_ia_i-\sum_{i=1}^{n_1-m} s_ib_i\)</span>.</p>
<p>注意到上式左边在 <span class="arithmatex">\(V_2\)</span> 中，右边在 <span class="arithmatex">\(V_1\)</span> 中，故两边均在 <span class="arithmatex">\(V_1\cap V_2\)</span> 中，因此 <span class="arithmatex">\(\sum_{i=1}^{n_2-m} t_ic_i=\sum_{i=1}^m k_ia_i\)</span></p>
<p>故 <span class="arithmatex">\(t_1=t_2=\dots=t_{n_2-m}=k_1=k_2=\dots=k_m=0\)</span>, 进而 <span class="arithmatex">\(r_1=r_2=\dots=r_m=s_1=s_2=\dots=s_{n_1-m}=t_1=t_2=\dots=t_{n_2-m}=0\)</span></p>
</details>
</li>
<li>
<p>令 <span class="arithmatex">\(V_1,V_2\)</span> 是关于 <span class="arithmatex">\(\Bbb{P}\)</span> 的有限维线性空间，且 <span class="arithmatex">\(V_1+V_2\)</span> 和 <span class="arithmatex">\(V_1\cap V_2\)</span> 也是有限维的，则下列诸款等价：</p>
<ol>
<li>
<p><span class="arithmatex">\(V_1+V_2=V_1\oplus V_2\)</span>.</p>
</li>
<li>
<p><span class="arithmatex">\(\dim V_1+\dim V_2=\dim(V_1+V_2)\)</span>.</p>
</li>
<li>
<p>若 <span class="arithmatex">\(a_1,a_2,\dots,a_n\)</span> 是 <span class="arithmatex">\(V_1\)</span> 的一组基，<span class="arithmatex">\(b_1,b_2,\dots,b_m\)</span> 是 <span class="arithmatex">\(V_2\)</span> 的一组基，则 <span class="arithmatex">\(a_1,a_2,\dots,a_n,b_1,b_2,\dots,b_m\)</span> 是 <span class="arithmatex">\(V_1+V_2\)</span> 的一组基。</p>
</li>
</ol>
<details class="note" open="open">
<summary>Note</summary>
<p>1,3 两条可推广到无限维线性空间中</p>
</details>
</li>
</ol>
<h2 id="例子">例子<a class="headerlink" href="#例子" title="Permanent link"></a></h2>
<p>考虑 <span class="arithmatex">\(\Bbb{R}^2\)</span> 的基。</p>
<ol>
<li>
<p>如图</p>
<p><img alt="" src="../images/basis-1.svg" /></p>
<p><span class="arithmatex">\(u,v\)</span> 是一组基。</p>
</li>
<li>
<p>如图</p>
<p><img alt="" src="../images/basis-2.svg" /></p>
<p><span class="arithmatex">\(u,v\)</span> 是一组基。</p>
</li>
<li>
<p>如图</p>
<p><img alt="" src="../images/basis-3.svg" /></p>
<p><span class="arithmatex">\(u,v\)</span> 不是一组基，因为 <span class="arithmatex">\(u=-v\)</span>.</p>
</li>
<li>
<p>如图</p>
<p><img alt="" src="../images/basis-4.svg" /></p>
<p><span class="arithmatex">\(u,v,w\)</span> 不是一组基，因为 <span class="arithmatex">\(u+4v+6w=\theta\)</span>.</p>
</li>
</ol>
<h2 id="正交基与单位正交基">正交基与单位正交基<a class="headerlink" href="#正交基与单位正交基" title="Permanent link"></a></h2>
<p>若线性空间 <span class="arithmatex">\(V\)</span> 的一组基 <span class="arithmatex">\(B\)</span> 满足 <span class="arithmatex">\(\forall b,b'\in B,~(b,b')\ne 0\iff b=b'\)</span>（即两两正交），则称这组基是 <strong>正交基</strong>。</p>
<p>若线性空间 <span class="arithmatex">\(V\)</span> 的一组正交基 <span class="arithmatex">\(B\)</span> 还满足 <span class="arithmatex">\(\forall b\in B,~|b|=\sqrt{(b,b)}=1\)</span>，则称这组基是 <strong>单位正交基</strong>。</p>
<p>任意有限维线性空间 <span class="arithmatex">\(V\)</span> 的基都可以通过 <a href="https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process">Schmidt 正交化</a> 变换为正交基。</p>
<h2 id="应用">应用<a class="headerlink" href="#应用" title="Permanent link"></a></h2>
<p>根据前文内容，我们可以利用线性基实现：</p>
<ol>
<li>求给定向量组的秩；</li>
<li>对给定的向量组，找到一组极大线性无关组（或其张成的线性空间的一组基）；</li>
<li>向给定的向量组插入某些向量，在插入操作后的向量组中找到一组极大线性无关组（或其张成的线性空间的一组基）；</li>
<li>对找到的一组极大线性无关组（或基），判断某向量能否被其线性表出；</li>
<li>对找到的一组极大线性无关组（或基），求其张成的线性空间中的特殊元素（如最大元、最小元等）。</li>
</ol>
<p>在 OI 中，我们一般将 <span class="arithmatex">\(n\)</span> 维实线性空间 <span class="arithmatex">\(\mathbf{R}^n\)</span> 下的线性基称为 <strong>实数线性基</strong>，<span class="arithmatex">\(n\)</span> 维布尔域线性空间 <span class="arithmatex">\(\mathbf{Z}_2^n\)</span> 下的线性基称为 <strong>异或线性基</strong>。</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p><span class="arithmatex">\(\mathbf{Z}_2\)</span> 中的加法为异或，乘法为与，可以证明 <span class="arithmatex">\(\mathbf{Z}_2\)</span> 是域。</p>
<p>可以证明代数系统 <span class="arithmatex">\((\mathbf{Z}_2^n,+,\cdot,\mathbf{Z}_2)\)</span> 是线性空间，其中：</p>
<div class="arithmatex">\[
(a_1,\dots,a_n)+(b_1,\dots,b_n):=(a_1+b_1,\dots,a_n+b_n),
\]</div>
<div class="arithmatex">\[
k\cdot(a_1,\dots,a_n):=(ka_1,\dots,ka_n).
\]</div>
<p>即加法是异或，数乘是与。</p>
</details>
<p>以异或线性基为例，我们可以根据给定的一组布尔序列 <span class="arithmatex">\(\{x_1,\dots,x_m\}\)</span> 构造出一组异或线性基 <span class="arithmatex">\(B=\{b_1,\dots,b_n\}\)</span>，这组基有如下性质：</p>
<ol>
<li><span class="arithmatex">\(B\)</span> 中任意非空子集的异或和不为 <span class="arithmatex">\(0\)</span>；</li>
<li>对 <span class="arithmatex">\(X\)</span> 中的任意元素 <span class="arithmatex">\(x\)</span>，都可在 <span class="arithmatex">\(B\)</span> 中取出若干元素使其异或和为 <span class="arithmatex">\(x\)</span>；</li>
<li>对任意满足上两条的集合 <span class="arithmatex">\(B'\)</span>，其元素个数不会小于 <span class="arithmatex">\(B\)</span> 的元素个数。</li>
</ol>
<p>我们可以利用异或线性基实现：</p>
<ol>
<li>判断一个数能否表示成某数集子集的异或和；</li>
<li>求一个数表示成某数集子集异或和的方案数；</li>
<li>求某数集子集的最大/最小/第 <span class="arithmatex">\(k\)</span> 大/第 <span class="arithmatex">\(k\)</span> 小异或和；</li>
<li>求一个数在某数集子集异或和中的排名。</li>
</ol>
<h3 id="构造方法">构造方法<a class="headerlink" href="#构造方法" title="Permanent link"></a></h3>
<p>因为异或线性基与实数线性基没有本质差别，所以接下来以异或线性基为例，实数线性基版本的代码只需做一点简单修改即可。</p>
<h4 id="贪心法">贪心法<a class="headerlink" href="#贪心法" title="Permanent link"></a></h4>
<p>对原集合的每个数 <span class="arithmatex">\(p\)</span> 转为二进制，从高位向低位扫，对于第 <span class="arithmatex">\(x\)</span> 位是 <span class="arithmatex">\(1\)</span> 的，如果 <span class="arithmatex">\(a_x\)</span> 不存在，那么令 <span class="arithmatex">\(a_x \leftarrow p\)</span> 并结束扫描，如果存在，令 <span class="arithmatex">\(p\leftarrow p~\text{xor}~a_x\)</span>。</p>
<p>查询原集合内任意几个元素 <span class="arithmatex">\(\text{xor}\)</span> 的最大值，只需将线性基从高位向低位扫，若 <span class="arithmatex">\(\text{xor}\)</span> 上当前扫到的 <span class="arithmatex">\(a_x\)</span> 答案变大，就把答案异或上 <span class="arithmatex">\(a_x\)</span>。</p>
<p>为什么能行呢？因为从高往低位扫，若当前扫到第 <span class="arithmatex">\(i\)</span> 位，意味着可以保证答案的第 <span class="arithmatex">\(i\)</span> 位为 <span class="arithmatex">\(1\)</span>，且后面没有机会改变第 <span class="arithmatex">\(i\)</span> 位。</p>
<p>查询原集合内任意几个元素 <span class="arithmatex">\(\text{xor}\)</span> 的最小值，就是线性基集合所有元素中最小的那个。</p>
<p>查询某个数是否能被异或出来，类似于插入，如果最后插入的数 <span class="arithmatex">\(p\)</span> 被异或成了 <span class="arithmatex">\(0\)</span>，则能被异或出来。</p>
<details class="example">
<summary>代码（洛谷 P3812 <a href="https://www.luogu.com.cn/problem/P3812">【模板】线性基</a>）</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-</span><span class="mi">-8</span><span class="o">&lt;--</span><span class="w"> </span><span class="s">&quot;docs/math/code/basis/basis_1.cpp&quot;</span>
</code></pre></div></td></tr></table></div>
</details>
<h4 id="高斯消元法">高斯消元法<a class="headerlink" href="#高斯消元法" title="Permanent link"></a></h4>
<p>高斯消元法相当于从线性方程组的角度去构造线性基，正确性显然。</p>
<details class="example">
<summary>代码（洛谷 P3812 <a href="https://www.luogu.com.cn/problem/P3812">【模板】线性基</a>）</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-</span><span class="mi">-8</span><span class="o">&lt;--</span><span class="w"> </span><span class="s">&quot;docs/math/code/basis/basis_2.cpp&quot;</span>
</code></pre></div></td></tr></table></div>
</details>
<h3 id="性质_1">性质<a class="headerlink" href="#性质_1" title="Permanent link"></a></h3>
<p>贪心法构造的线性基具有如下性质：</p>
<ul>
<li>线性基没有异或和为 <span class="arithmatex">\(0\)</span> 的子集。</li>
<li>线性基中各数二进制最高位不同。</li>
</ul>
<p>高斯消元法构造出的线性基满足如下性质：</p>
<ul>
<li>
<p>高斯消元后的矩阵是一个行简化阶梯形矩阵。</p>
<blockquote>
<p>该性质包含了贪心法构造的线性基满足的两条性质</p>
</blockquote>
<p>如果不理解这条性质的正确性，可以跳转 <a href="../../numerical/gauss/">高斯消元</a>。</p>
</li>
</ul>
<p>提供一组样例：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>5
633 211 169 841 1008
</code></pre></div></td></tr></table></div>
<p>二进制表示：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>1001111001
0011010011
0010101001
1101001001
1111110000
</code></pre></div></td></tr></table></div>
<p>贪心法生成的线性基：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code>1001111001
0100110000
0011010011
0001111010
0000000000
0000010000
0000000000
0000000000
0000000000
0000000000
</code></pre></div></td></tr></table></div>
<p>高斯消元法生成的线性基：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code>1000000011
0100100000
0010101001
0001101010
0000010000
0000000000
0000000000
0000000000
0000000000
0000000000
</code></pre></div></td></tr></table></div>
<p>这是一条非常好的性质，能帮我们更方便的解决很多问题。比如：给定一些数，选其中一些异或起来，求异或最大值，如果用贪心法构造线性基，需要再做一遍贪心，如果 <code>ans</code> 的当前位是 <code>0</code>，那么异或一定会更优，否则当前位如果为 <code>1</code>，则一定不会更优；而使用高斯消元法构造线性基后直接将线性基中所有元素都异或起来输出即可。</p>
<p>对于其他比较经典的问题（查询一个数能否被异或得到，查询能被异或得到的第 <span class="arithmatex">\(k\)</span> 大数等），高斯消元法得到的线性基也能更加方便地解决。</p>
<h3 id="时间复杂度">时间复杂度<a class="headerlink" href="#时间复杂度" title="Permanent link"></a></h3>
<p>设向量长度为 <span class="arithmatex">\(n\)</span>, 总数为 <span class="arithmatex">\(m\)</span>, 则时间复杂度为 <span class="arithmatex">\(O(nm)\)</span>. 其中高斯消元法的常数略大。</p>
<p>若是实数线性基，则时间复杂度为 <span class="arithmatex">\(O(n^2m)\)</span>.</p>
<h3 id="线性基合并">线性基合并<a class="headerlink" href="#线性基合并" title="Permanent link"></a></h3>
<p>线性基的合并只需要暴力处理，即将要合并的一组线性基暴力地插入到另一组线性基即可。单次合并的时间复杂度是 <span class="arithmatex">\(O(n^2)\)</span>（异或线性基）或 <span class="arithmatex">\(O(n^3)\)</span>（实数线性基）。</p>
<h3 id="线性基求交">线性基求交<a class="headerlink" href="#线性基求交" title="Permanent link"></a></h3>
<p>线性基求交，严格地说就是求它们张成的两个线性空间的交空间的一组线性基。本节介绍两种算法。这两种算法，单次求交的时间复杂度都是 <span class="arithmatex">\(O(n^2)\)</span>（异或线性基）或 <span class="arithmatex">\(O(n^3)\)</span>（实数线性基）。</p>
<h4 id="朴素算法">朴素算法<a class="headerlink" href="#朴素算法" title="Permanent link"></a></h4>
<p>设要求交的线性基分别是 <span class="arithmatex">\(\alpha\)</span> 和 <span class="arithmatex">\(\beta\)</span>。线性基求交的算法只需要对线性基暴力合并的算法做如下调整：（以异或线性基为例）</p>
<ul>
<li>将线性基 <span class="arithmatex">\(\beta\)</span> 中的向量 <span class="arithmatex">\(\beta_j\)</span> 利用 <a href="#贪心法">贪心法</a> 尝试插入到 <span class="arithmatex">\(\alpha\)</span> 中，并初始化线性基的交 <span class="arithmatex">\(\gamma\)</span> 为空集；</li>
<li>在插入时，需要记录要插入的向量中，线性基 <span class="arithmatex">\(\beta\)</span> 中元素的贡献。具体地，维持一个新向量 <span class="arithmatex">\(b\)</span>，初始化为 <span class="arithmatex">\(\beta_j\)</span>，而且，如果正在插入的向量与线性基中第 <span class="arithmatex">\(x\)</span> 位的向量取了异或，那么贡献 <span class="arithmatex">\(b\)</span> 也要与第 <span class="arithmatex">\(x\)</span> 位记录的贡献 <span class="arithmatex">\(b_x\)</span> 取一次异或；</li>
<li>如果插入成功，在线性基的第 <span class="arithmatex">\(x\)</span> 位插入了向量 <span class="arithmatex">\(\beta_j'\)</span>，就将第 <span class="arithmatex">\(x\)</span> 位记录的 <span class="arithmatex">\(b_x\)</span> 改为得到 <span class="arithmatex">\(\beta_j'\)</span> 的过程中线性基 <span class="arithmatex">\(\beta\)</span> 中元素的贡献 <span class="arithmatex">\(b\)</span>；</li>
<li>如果插入不成功，就将过程中记录到的线性基 <span class="arithmatex">\(\beta\)</span> 中元素的贡献 <span class="arithmatex">\(b\)</span> 插入到 <span class="arithmatex">\(\gamma\)</span> 中。</li>
</ul>
<p>这样得到的线性基 <span class="arithmatex">\(\gamma\)</span> 就是所求的交，当然，该算法同时也求出了线性基的并。</p>
<details class="note">
<summary>对算法的解释</summary>
<p>设合并后的线性基为 <span class="arithmatex">\(\{\alpha_1,\cdots,\alpha_m,\beta'_{j_1},\cdots,\beta'_{j_\ell}\}\)</span>，其中，<span class="arithmatex">\(\beta'_{j_k}\)</span> 是插入 <span class="arithmatex">\(\beta_{j_k}\)</span> 时最后得到的向量。那么，<span class="arithmatex">\(\{\alpha_1,\cdots,\alpha_m,\beta_{j_1},\cdots,\beta_{j_\ell}\}\)</span> 同样是一组合并后的线性基。记 <span class="arithmatex">\(\beta^+\)</span> 为集合 <span class="arithmatex">\(\{\beta_{j_1},\cdots,\beta_{j_\ell}\}\)</span>，则合并后的基可以写作 <span class="arithmatex">\(\alpha\cup\beta^+\)</span>。而且，和空间中的每个向量 <span class="arithmatex">\(c\)</span> 都可以唯一地表示成</p>
<div class="arithmatex">\[
c = a\oplus b
\]</div>
<p>的形式，其中，<span class="arithmatex">\(a\in\operatorname{span}\alpha\)</span> 且 <span class="arithmatex">\(b\in\operatorname{span}\beta^+\)</span>。这个分解中的 <span class="arithmatex">\(b\)</span> 就是前文算法所 <strong>试图</strong> 记录的「线性基 <span class="arithmatex">\(\beta\)</span> 中元素的贡献」。严格地说，只是 <span class="arithmatex">\(\beta\)</span> 中最后成功插入的那些向量的贡献。</p>
<p>对于成功的插入，最后记录的 <span class="arithmatex">\(b\)</span> 就是该分解中的 <span class="arithmatex">\(b\)</span> 项。设 <span class="arithmatex">\(\beta_j\in\beta^+\)</span>。初始时，<span class="arithmatex">\(\beta_j=0\oplus\beta_j\)</span>，已经是 <span class="arithmatex">\(\beta_j\)</span> 在基 <span class="arithmatex">\(\alpha\cup\beta^+\)</span> 上的正确的分解。在更新 <span class="arithmatex">\(\beta'_j=a\oplus b\)</span> 为 <span class="arithmatex">\(\beta'_j\oplus c_x\)</span> 时，因为 <span class="arithmatex">\(\beta_j'\oplus c_x=(a\oplus a_x)\oplus(b\oplus b_x)\)</span>，所以，只需要更新 <span class="arithmatex">\(b\)</span> 为 <span class="arithmatex">\(b\oplus b_x\)</span>，就可以保证分解依然正确。因此，归纳可知，最后插入 <span class="arithmatex">\(\beta'_j\)</span> 到合并后的线性基中时，记录的贡献 <span class="arithmatex">\(b\)</span> 就是上述分解中的 <span class="arithmatex">\(b\)</span> 项。</p>
<p>对于不成功的插入，最后要插入的变量一定会变成 <span class="arithmatex">\(0\)</span>，而此时的贡献 <span class="arithmatex">\(b\)</span> 要插入到 <span class="arithmatex">\(\gamma\)</span> 中。此时，如果重复上面的论证，会发现仍然能够保证在插入过程中总是有 <span class="arithmatex">\(\beta_j'=a\oplus b\)</span>，且 <span class="arithmatex">\(a\in\operatorname{span}\alpha\)</span>，只是 <span class="arithmatex">\(b\)</span> 不再属于 <span class="arithmatex">\(\operatorname{span}\beta^+\)</span>。这是因为初始化时，<span class="arithmatex">\(\beta_j=0\oplus\beta_j\)</span> 中的 <span class="arithmatex">\(\beta_j\notin\beta^+\)</span>。除此之外，贡献更新时异或的项都属于 <span class="arithmatex">\(\operatorname{span}\beta^+\)</span>。所以，实际上，有 <span class="arithmatex">\(b\oplus\beta_j\in\operatorname{span}\beta^+\)</span>。</p>
<p>那么，为什么将这些插入不成功时的 <span class="arithmatex">\(b\)</span> 都插入到 <span class="arithmatex">\(\gamma\)</span> 中，就能得到交空间的线性基呢？首先，插入 <span class="arithmatex">\(\beta_j\)</span> 不成功，最后一定会得到 <span class="arithmatex">\(0=a\oplus b\)</span>，其中，<span class="arithmatex">\(a\in\operatorname{span}\alpha\)</span> 且 <span class="arithmatex">\(b\in\operatorname{span}(\beta^+\cup\{\beta_j\})\subseteq\operatorname{span}\beta\)</span>。因此，<span class="arithmatex">\(b=a\)</span> 必然位于交空间 <span class="arithmatex">\(\operatorname{span}\alpha\cap\operatorname{span}\beta\)</span> 中。反过来，设 <span class="arithmatex">\(c\)</span> 是交空间中的任意元素，因为 <span class="arithmatex">\(c\in\operatorname{span}\beta\)</span>，所以 <span class="arithmatex">\(c\)</span> 可以表示为 <span class="arithmatex">\(\beta\)</span> 中元素的线性组合（异或和）：</p>
<div class="arithmatex">\[
c = \bigoplus_{\beta_j\in\beta}\lambda_j\beta_j,
\]</div>
<p>其中，<span class="arithmatex">\(\lambda_j\in\{0,1\}\)</span>。对于每一个 <span class="arithmatex">\(\beta_j\notin\beta^+\)</span>，记相应的插入到 <span class="arithmatex">\(\gamma\)</span> 中的贡献为 <span class="arithmatex">\(b_j\)</span>，就有</p>
<div class="arithmatex">\[
c\oplus\bigoplus_{\beta_j\notin\beta^+}\lambda_jb_j = \bigoplus_{\beta_j\in\beta^+}\lambda_j\beta_j+\bigoplus_{\beta_j\notin\beta^+}\lambda_j(\beta_j\oplus b_j),
\]</div>
<p>注意到，<span class="arithmatex">\(b_j\)</span> 和 <span class="arithmatex">\(c\)</span> 都位于交空间中，因而左侧必然也位于交空间中，故而左侧可以写成 <span class="arithmatex">\(\alpha\)</span> 中元素的线性组合；同时，右侧所有项，要么 <span class="arithmatex">\(\beta_j\in\beta^+\)</span>，要么 <span class="arithmatex">\(\beta_j\notin\beta^+\)</span> 且 <span class="arithmatex">\(\beta_j\oplus b_j\in\beta^+\)</span>，故而，右侧实际上是 <span class="arithmatex">\(\beta^+\)</span> 中元素的线性组合。但是，<span class="arithmatex">\(\alpha\cup\beta^+\)</span> 线性无关，故而所有的系数都是 <span class="arithmatex">\(0\)</span>，也就是说 <span class="arithmatex">\(c=\bigoplus_{\beta_j\notin\beta^+}\lambda_jb_j\in\operatorname{span}\{b_1,\cdots,b_j\}\)</span>。这就说明了，这些无法插入的向量的贡献 <span class="arithmatex">\(b\)</span> 共同张成了交空间。</p>
<p>根据这一解释，过程中维护贡献 <span class="arithmatex">\(b\)</span> 的目的，实际上是为了维护分解 <span class="arithmatex">\(a\oplus b\)</span>；而且，最后向 <span class="arithmatex">\(\gamma\)</span> 插入贡献时也总有 <span class="arithmatex">\(a=b\)</span>。所以，无论维护 <span class="arithmatex">\(\alpha\)</span> 还是 <span class="arithmatex">\(\beta\)</span> 中元素的贡献（即无论维护 <span class="arithmatex">\(a\)</span> 还是 <span class="arithmatex">\(b\)</span>），得到的结果都是正确的。如果要维护线性基 <span class="arithmatex">\(\alpha\)</span> 中元素的贡献，只需要修改初始化时相应贡献的取值：每个 <span class="arithmatex">\(\alpha\)</span> 中的向量 <span class="arithmatex">\(\alpha_i\)</span> 初始就有贡献 <span class="arithmatex">\(\alpha_i\)</span>，而插入的 <span class="arithmatex">\(\beta_j\)</span> 初始贡献为 <span class="arithmatex">\(0\)</span>。</p>
</details>
<p>模板题代码如下：</p>
<details class="example">
<summary>代码（Library Checker <a href="https://judge.yosupo.jp/problem/intersection_of_f2_vector_spaces">Intersection of <span class="arithmatex">\(\mathbf F_2\)</span> vector spaces</a>）</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-</span><span class="mi">-8</span><span class="o">&lt;--</span><span class="w"> </span><span class="s">&quot;docs/math/code/basis/basis_intersect_1.cpp&quot;</span>
</code></pre></div></td></tr></table></div>
</details>
<h4 id="zassenhaus-算法">Zassenhaus 算法<a class="headerlink" href="#zassenhaus-算法" title="Permanent link"></a></h4>
<p>另一种等价的做法是 Zassenhaus 算法，它同样可以同时计算出两个线性基的并和交。复杂度和上文完全一致。</p>
<p>具体步骤如下：</p>
<ul>
<li>初始化一个向量长度为 <span class="arithmatex">\(2n\)</span> 的线性基 <span class="arithmatex">\(\gamma\)</span> 为空，其中的向量写成 <span class="arithmatex">\((a,b)\)</span> 的形式，且 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 长度均为 <span class="arithmatex">\(n\)</span>；</li>
<li>将 <span class="arithmatex">\(\alpha\)</span> 中的元素 <span class="arithmatex">\(\alpha_i\)</span> 以 <span class="arithmatex">\((\alpha_i,\alpha_i)\)</span> 的形式插入 <span class="arithmatex">\(\gamma\)</span> 中；</li>
<li>将 <span class="arithmatex">\(\beta\)</span> 中的元素 <span class="arithmatex">\(\beta_j\)</span> 以 <span class="arithmatex">\((\beta_j,0)\)</span> 的形式插入 <span class="arithmatex">\(\gamma\)</span> 中；</li>
<li>最后得到的线性基 <span class="arithmatex">\(\gamma\)</span> 中的所有非零元素 <span class="arithmatex">\((c_k,d_k)\)</span> 中，<span class="arithmatex">\(c_k\)</span> 非零的那些向量中项 <span class="arithmatex">\(c_k\)</span> 的全体组成了 <span class="arithmatex">\(\alpha\)</span> 和 <span class="arithmatex">\(\beta\)</span> 的并的线性基，<span class="arithmatex">\(c_k\)</span> 为零的那些向量中项 <span class="arithmatex">\(d_k\)</span> 的全体组成了 <span class="arithmatex">\(\alpha\)</span> 和 <span class="arithmatex">\(\beta\)</span> 的交的线性基。</li>
</ul>
<p>算法中的构造线性基的方法可以是 <a href="#贪心法">贪心法</a> 或 <a href="#高斯消元法">高斯消元法</a>，只要保证 <span class="arithmatex">\(\gamma\)</span> 中的线性基组成行阶梯型矩阵即可。</p>
<p>将 Zassenhaus 算法中的消元的步骤与上面的朴素算法相比较，很容易发现，基于贪心法的 Zassenhaus 算法相当于维护 <span class="arithmatex">\(\alpha\)</span> 中元素的贡献的朴素算法。如果转而先插入所有 <span class="arithmatex">\((\alpha_i,0)\)</span>，再插入所有 <span class="arithmatex">\((\beta_j,\beta_j)\)</span>，那么基于贪心法的 Zassenhaus 算法就相当于维护 <span class="arithmatex">\(\beta\)</span> 中元素贡献的朴素算法。根据消元步骤的等价性，Zassenhaus 算法的正确性也是成立的。</p>
<p>除此之外，还可以再提供一个独立且更为一般的代数证明：</p>
<details class="note">
<summary>正确性证明</summary>
<p>设 <span class="arithmatex">\(V\)</span> 为一线性空间，且有子空间 <span class="arithmatex">\(U=\operatorname{span}\alpha\)</span> 和 <span class="arithmatex">\(W=\operatorname{span}\beta\)</span>。算法本身相当于通过化简为行阶梯型来求子空间</p>
<div class="arithmatex">\[
H = \operatorname{span}(\{(\alpha_i,\alpha_i):\alpha_i\in\alpha\}\cup\{(\beta_j,0):\beta_j\in\beta\})
\]</div>
<p>的一组基 <span class="arithmatex">\(\gamma\)</span>。算法最后，<span class="arithmatex">\(\gamma\)</span> 中的元素 <span class="arithmatex">\((c_k,d_k)\)</span> 根据 <span class="arithmatex">\(c_k\neq 0\)</span> 与否需要分为两类，所以不妨考察投影映射 <span class="arithmatex">\(\pi:H\rightarrow V\)</span> 且 <span class="arithmatex">\(\pi(a,b)=a\)</span>。于是，<span class="arithmatex">\(\pi(H)=U+W\)</span> 且容易验证</p>
<div class="arithmatex">\[
\begin{aligned}
\ker\pi &amp;= H\cap(\{0\}\times V) = \{0\}\times(U\times W).
\end{aligned}
\]</div>
<p>根据 <a href="../linear-mapping/#线性映射的核空间与像空间">线性映射的相关定理</a>，有 <span class="arithmatex">\(\dim H = \dim\pi(H)+\dim\ker\pi = \dim(U+W)+\dim(U\cap W)\)</span>。</p>
<p>行阶梯型矩阵的前几列仍然是行阶梯型矩阵，因而 <span class="arithmatex">\(c_k\neq 0\)</span> 的行的数目，恰好等于 <span class="arithmatex">\(\alpha\cup\beta\)</span> 的行秩，亦即 <span class="arithmatex">\(\dim(U+W)\)</span>；而且，这些行中 <span class="arithmatex">\(c_k\)</span> 的集合就形成了 <span class="arithmatex">\(U+W\)</span> 的一组基。剩下的非零行恰好有 <span class="arithmatex">\(\dim(U\cap W)\)</span> 个，且都满足 <span class="arithmatex">\(c_k=0\)</span>。对于这些行中的 <span class="arithmatex">\(d_k\)</span>，因为有 <span class="arithmatex">\((0,d_k)\in\ker\pi\)</span>，所以 <span class="arithmatex">\(d_k\in U\cap W\)</span>；而且，<span class="arithmatex">\((0,d_k)\)</span> 作为行阶梯型矩阵的行，必然线性无关，这就说明这些 <span class="arithmatex">\(d_k\)</span> 都线性无关。综合起来，这些 <span class="arithmatex">\(d_k\)</span> 是交空间 <span class="arithmatex">\(U\cap W\)</span> 中大小为 <span class="arithmatex">\(\dim(U\cap W)\)</span> 的线性无关组，所以也必然是该空间的一组基。</p>
</details>
<p>模板题代码如下：</p>
<details class="example">
<summary>代码（Library Checker <a href="https://judge.yosupo.jp/problem/intersection_of_f2_vector_spaces">Intersection of <span class="arithmatex">\(\mathbf F_2\)</span> vector spaces</a>）</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-</span><span class="mi">-8</span><span class="o">&lt;--</span><span class="w"> </span><span class="s">&quot;docs/math/code/basis/basis_intersect_2.cpp&quot;</span>
</code></pre></div></td></tr></table></div>
</details>
<p>注意，输出时只需要考虑前 <span class="arithmatex">\(n\)</span> 位均为零的向量即可。</p>
<h3 id="拓展前缀线性基">拓展：前缀线性基<a class="headerlink" href="#拓展前缀线性基" title="Permanent link"></a></h3>
<p>本节只讨论异或线性基的情形，并假设单个向量可以存储在 <span class="arithmatex">\(O(1)\)</span> 的空间内，且单次操作复杂度总是 <span class="arithmatex">\(O(1)\)</span> 的。</p>
<p>对于需要多次查询区间异或最大值的情形，一种常见的做法是 <a href="../../ds/cat-tree.md">猫树</a> 配合线性基，时间复杂度为 <span class="arithmatex">\(O(nm\log m+n^2q)\)</span>，其中，<span class="arithmatex">\(n\)</span> 是向量长度，<span class="arithmatex">\(m\)</span> 是序列长度，<span class="arithmatex">\(q\)</span> 是询问次数。另一种可行的做法是利用前缀线性基（或称时间戳线性基），可以将复杂度降低到 <span class="arithmatex">\(O(n(m+q))\)</span>。</p>
<p>前缀线性基允许对于序列的每个前缀，都维护该前缀的所有后缀的线性基，这样就可以支持查询每个区间的线性基。注意到序列的某个前缀 <span class="arithmatex">\([1,i]\)</span> 的所有后缀 <span class="arithmatex">\([j,i]\)</span> 的线性基是相互包含的，即 <span class="arithmatex">\([j,i]\)</span> 的线性基总是包含着 <span class="arithmatex">\([j+1,i]\)</span> 的线性基，所以，这些后缀的线性基中互不相同的至多只有 <span class="arithmatex">\(n\)</span> 种，而且总是可以通过向空集中逐步添加新的向量来得到自 <span class="arithmatex">\([i,i]\)</span> 到 <span class="arithmatex">\([1,i]\)</span> 所有这些后缀的线性基。因此，利用这个单调性，只需要为添加的每个向量 <span class="arithmatex">\(v\)</span>，都标记它出现的最大下标 <span class="arithmatex">\(t\)</span>，就可以在 <span class="arithmatex">\(O(n)\)</span> 的空间内存储所有后缀的线性基。而且，查询区间 <span class="arithmatex">\([j,i]\)</span> 对应的线性基时，只需要在 <span class="arithmatex">\(i\)</span> 处的前缀线性基中仅保留标记 <span class="arithmatex">\(t\ge j\)</span> 的那些向量即可。</p>
<p>不妨将每个向量 <span class="arithmatex">\(v\)</span> 的标记 <span class="arithmatex">\(t\)</span> 称为它的时间戳。线性基中的向量 <span class="arithmatex">\(v\)</span> 总是可以表示为原序列中某些元素的异或和，比如 <span class="arithmatex">\(v_{i_1}\oplus v_{i_2}\oplus\cdots\oplus v_{i_k}\)</span>。而在所有这样的可能的表示中，最小下标的最大值就是 <span class="arithmatex">\(t\)</span>，即</p>
<div class="arithmatex">\[
t(v) = \max\{j:\exists i_1,\cdots,i_k\in[j,i]\text{ s.t. }v=v_{i_1}\oplus v_{i_2}\oplus\cdots\oplus v_{i_k}\}.
\]</div>
<p>这个表达式不过是将上一段的叙述用形式的语言写出来而已。它给我们带来的启发是，要维护线性基中每个向量 <span class="arithmatex">\(v\)</span> 的时间戳，只需要贪心地选取尽可能新的向量替换掉旧的向量即可。</p>
<p>基于上文提到的 <a href="#贪心法">贪心法</a> 构造线性基，前缀线性基在构造过程中做了如下调整：</p>
<ul>
<li>为线性基中保留的每个向量 <span class="arithmatex">\(a_x\)</span> 都保存一个时间戳 <span class="arithmatex">\(t_x\)</span>，初始时均设为 <span class="arithmatex">\(0\)</span>；</li>
<li>要添加序列中第 <span class="arithmatex">\(i\)</span> 个向量 <span class="arithmatex">\(v\)</span>，仍然从高位向低位扫，但同时需要记录当前时间 <span class="arithmatex">\(i\)</span>；</li>
<li>如果 <span class="arithmatex">\(v\)</span> 的第 <span class="arithmatex">\(x\)</span> 位是一，就比较线性基中已有的向量 <span class="arithmatex">\(a_x\)</span> 的时间戳 <span class="arithmatex">\(t_x\)</span> 和当前时间 <span class="arithmatex">\(i\)</span>：<ul>
<li>如果 <span class="arithmatex">\(i&gt;t_x\)</span>，即要添加的向量时间更晚，就将 <span class="arithmatex">\(a_x\)</span> 设为 <span class="arithmatex">\(v\)</span>，并更新时间戳为 <span class="arithmatex">\(i\)</span>，并将旧的 <span class="arithmatex">\(a_x\)</span> 异或 <span class="arithmatex">\(v\)</span> 的结果 <span class="arithmatex">\(a_x\oplus v\)</span> 按照之前记录的时间 <span class="arithmatex">\(t_x\)</span> 继续添加过程；</li>
<li>如果 <span class="arithmatex">\(i&lt;t_x\)</span>，即要添加的向量时间更早，不更新 <span class="arithmatex">\(a_x\)</span> 和 <span class="arithmatex">\(t_x\)</span>，将 <span class="arithmatex">\(v\)</span> 异或 <span class="arithmatex">\(a_x\)</span> 后继续添加即可。</li>
</ul>
</li>
</ul>
<p>也就是说，如果当前位可以通过较新的向量表示，就直接用较新的向量；否则，保留原来的向量。在更新位置 <span class="arithmatex">\(x\)</span> 的向量时，不能将异或的结果 <span class="arithmatex">\(a_x\oplus v\)</span> 存入位置 <span class="arithmatex">\(x\)</span>，因为异或的结果 <span class="arithmatex">\(a_x\oplus v\)</span> 的时间戳为 <span class="arithmatex">\(\min\{t(a_x)=t(v)\}=t(a_x)\)</span>，小于要添加的变量 <span class="arithmatex">\(v\)</span> 的时间戳 <span class="arithmatex">\(t(v)\)</span>。同样的原因，<a href="#高斯消元法">高斯消元法</a> 构造线性基的过程中向上更新时可能会破坏时间戳的性质，所以不再适用于构造前缀线性基。</p>
<p>模板题代码如下：</p>
<details class="example">
<summary>代码（Codeforces <a href="https://codeforces.com/problemset/problem/1100/F">1100F Ivan and Burgers</a>）</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-</span><span class="mi">-8</span><span class="o">&lt;--</span><span class="w"> </span><span class="s">&quot;docs/math/code/basis/prefix_basis.cpp&quot;</span>
</code></pre></div></td></tr></table></div>
</details>
<p>如果需要在线询问，也可以用 <span class="arithmatex">\(O(mn)\)</span> 的空间将每个前缀处的前缀线性基都存下来再查询，这可以看作是一种「可持久化」线性基。如果需要用到高斯消元法得到的线性基的性质，可以在查询时另行处理。</p>
<h3 id="练习题">练习题<a class="headerlink" href="#练习题" title="Permanent link"></a></h3>
<ul>
<li><a href="https://www.luogu.com.cn/problem/P3812">Luogu P3812【模板】线性基</a></li>
<li><a href="https://www.acwing.com/problem/content/description/3167">Acwing 3164. 线性基</a></li>
<li><a href="https://codeforces.com/problemsets/acmsguru/problem/99999/275">SGU 275 to xor or not xor</a></li>
<li><a href="https://acm.hdu.edu.cn/showproblem.php?pid=3949">HDU 3949 XOR</a></li>
<li><a href="https://acm.hdu.edu.cn/showproblem.php?pid=6579">HDU 6579 Operation</a></li>
<li><a href="https://www.luogu.com.cn/problem/P4151">Luogu P4151 [WC2011] 最大 XOR 和路径</a></li>
<li><a href="https://judge.yosupo.jp/problem/intersection_of_f2_vector_spaces">Library Checker - Intersection of <span class="arithmatex">\(\mathbf F_2\)</span> vector spaces</a></li>
<li><a href="https://atcoder.jp/contests/agc045/tasks/agc045_a">AtCoder Grand Contest 045 A - Xor Battle</a></li>
<li><a href="https://codeforces.com/problemset/problem/1100/F">Codeforces 1100F Ivan and Burgers</a></li>
<li><a href="https://www.luogu.com.cn/problem/P3292">Luogu P3292 [SCOI2016] 幸运数字</a></li>
</ul>
<h2 id="参考资料与注释">参考资料与注释<a class="headerlink" href="#参考资料与注释" title="Permanent link"></a></h2>
<ol>
<li>丘维声，高等代数（下）。清华大学出版社。</li>
<li><a href="https://en.wikipedia.org/wiki/Basis_%28linear_algebra%29">Basis (linear algebra) - Wikipedia</a></li>
<li><a href="https://mathworld.wolfram.com/VectorBasis.html">Vector Basis -- from Wolfram MathWorld</a></li>
<li><a href="https://en.wikipedia.org/wiki/Zassenhaus_algorithm">Zassenhaus algorithm - Wikipedia</a></li>
</ol>
<div class="footnote">
<hr />
<ol>
<li id="fn:existence_basis">
<p><a href="https://en.wikipedia.org/wiki/Basis_%28linear_algebra%29#Proof_that_every_vector_space_has_a_basis">Proof that every vector space has a basis</a>&#160;<a class="footnote-backref" href="#fnref:existence_basis" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.expand", "navigation.tabs"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../_static/js/math-csr.js?math-csr"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>