
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="billchenchina, c-forrest, CCXXXI, danielqfmai, Enter-tainer, Great-designer, HeRaNO, lychees, Menci, Nanarikom, ouuan, shuzhouliu, sshwy, Tiphereth-A">
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Dirichlet - Math-wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dirichlet-卷积" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Math-wiki" class="md-header__button md-logo" aria-label="Math-wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Math-wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Dirichlet
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  简介

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ineq/" class="md-tabs__link">
          
  
  
  不等式

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../basic/" class="md-tabs__link">
          
  
  
  数论

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../complex/" class="md-tabs__link">
          
  
  
  杂项

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Math-wiki" class="md-nav__button md-logo" aria-label="Math-wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Math-wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    简介
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    不等式
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    不等式
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    最最最基本的不等关系
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/am-gm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    均值不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ineq/cauchy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    柯西不等式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    数论
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    数论
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    基础知识
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mod-arithmetic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    模运算
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    质数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gcd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    最大公约数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bezouts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bezout定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    逆元
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    中国剩余定理（CRT）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../euler-function.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    欧拉函数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fermat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    费马小定理与欧拉定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../primitive-root/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    阶与原根
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../congruence-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    同余方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear-congruence-equation.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    线性同余方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quadratic-residue.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    二次剩余
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pell-equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pell方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mobius/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    莫比乌斯反演
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lifting-the-exponent.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LTE引理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quadratic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    二次域
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    杂项
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    杂项
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../complex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    复数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dirichlet-卷积" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dirichlet 卷积
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dirichlet 卷积">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#性质" class="md-nav__link">
    <span class="md-ellipsis">
      
        性质
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dirichlet-生成函数" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dirichlet 生成函数
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dirichlet 生成函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#euler-乘积" class="md-nav__link">
    <span class="md-ellipsis">
      
        Euler 乘积
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#应用" class="md-nav__link">
    <span class="md-ellipsis">
      
        应用
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dirichlet-卷积的计算" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dirichlet 卷积的计算
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dirichlet 卷积的计算">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#一般情形" class="md-nav__link">
    <span class="md-ellipsis">
      
        一般情形
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#与积性函数卷积的情形" class="md-nav__link">
    <span class="md-ellipsis">
      
        与积性函数卷积的情形
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#结果为积性函数的情形" class="md-nav__link">
    <span class="md-ellipsis">
      
        结果为积性函数的情形
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#参考资料与注释" class="md-nav__link">
    <span class="md-ellipsis">
      
        参考资料与注释
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Dirichlet</h1>

<p>本文介绍 Dirichlet 卷积和 Dirichlet 生成函数．</p>
<h2 id="dirichlet-卷积">Dirichlet 卷积<a class="headerlink" href="#dirichlet-卷积" title="Permanent link"></a></h2>
<p>数论函数 <span class="arithmatex">\(f(n)\)</span> 和 <span class="arithmatex">\(g(n)\)</span> 的 <strong>Dirichlet 卷积</strong>（Dirichlet convolution），记作 <span class="arithmatex">\(f \ast g\)</span>，定义为数论函数</p>
<div class="arithmatex">\[
(f \ast g)(n) = \sum_{k\mid n}f(k)g\left(\dfrac{n}{k}\right) = \sum_{k\ell=n}f(k)g(\ell).
\]</div>
<p>Dirichlet 卷积是数论函数的重要运算．数论函数的许多性质都是通过这个运算挖掘出来的．</p>
<details class="example" open="open">
<summary>例子</summary>
<ol>
<li>单位函数 <span class="arithmatex">\(\varepsilon\)</span> 是莫比乌斯函数 <span class="arithmatex">\(\mu\)</span> 和常数函数 <span class="arithmatex">\(1\)</span> 的 Dirichlet 卷积：</li>
</ol>
<div class="arithmatex">\[
\varepsilon=\mu \ast 1 \iff\varepsilon(n)=\sum_{d\mid n}\mu(d).
\]</div>
<ol>
<li>除数个数函数 <span class="arithmatex">\(\tau\)</span> 是常数函数 <span class="arithmatex">\(1\)</span> 和它自身的 Dirichlet 卷积：</li>
</ol>
<div class="arithmatex">\[
\tau=1 \ast 1 \iff \tau(n)=\sum_{d\mid n}1.
\]</div>
<ol>
<li>除数和函数 <span class="arithmatex">\(\sigma\)</span> 是恒等函数 <span class="arithmatex">\(\mathrm{id}\)</span> 和常数函数 <span class="arithmatex">\(1\)</span> 的 Dirichlet 卷积：</li>
</ol>
<div class="arithmatex">\[
\sigma=\mathrm{id} \ast 1 \iff\sigma(n)=\sum_{d\mid n}d.
\]</div>
<ol>
<li>欧拉函数 <span class="arithmatex">\(\varphi\)</span> 是恒等函数 <span class="arithmatex">\(\mathrm{id}\)</span> 和莫比乌斯函数 <span class="arithmatex">\(\mu\)</span> 的 Dirichlet 卷积：</li>
</ol>
<div class="arithmatex">\[
\varphi=\mathrm{id}\ast \mu \iff\varphi(n)=\sum_{d\mid n}d\cdot\mu\left(\frac{n}{d}\right).
\]</div>
</details>
<p><a href="../mobius/">莫比乌斯反演</a> 就是利用 <span class="arithmatex">\(\varepsilon=\mu \ast 1\)</span> 对数论函数恒等式进行变形．</p>
<h3 id="性质">性质<a class="headerlink" href="#性质" title="Permanent link"></a></h3>
<p>Dirichlet 卷积具有一系列代数性质．</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设 <span class="arithmatex">\(f,g,h\)</span> 都是数论函数．那么，有：</p>
<ol>
<li><strong>交换律</strong>：<span class="arithmatex">\(f\ast g=g\ast f\)</span>．</li>
<li><strong>结合律</strong>：<span class="arithmatex">\((f\ast g)\ast h=f\ast(g\ast h)\)</span>．</li>
<li><strong>分配律</strong>：<span class="arithmatex">\((f+g)\ast h = f\ast h + g\ast h\)</span>．</li>
<li><strong>单位元</strong>：<span class="arithmatex">\(f\ast\varepsilon = \varepsilon \ast f = f\)</span>，其中，<span class="arithmatex">\(\varepsilon(n) = [n=1]\)</span> 是卷积单位元，<span class="arithmatex">\([\cdot]\)</span> 是 Iverson 括号．</li>
<li><strong>逆元</strong>：当且仅当 <span class="arithmatex">\(f(1)\neq 0\)</span> 时，存在 <span class="arithmatex">\(g\)</span> 使得 <span class="arithmatex">\(f\ast g=g\ast f=\varepsilon\)</span>，且 <span class="arithmatex">\(g\)</span> 称为 <span class="arithmatex">\(f\)</span> 的 <strong>Dirichlet 逆元</strong>（Dirichlet inverse），可以记作 <span class="arithmatex">\(f^{-1}\)</span>．而且，逆元 <span class="arithmatex">\(g\)</span> 满足递推公式</li>
</ol>
<div class="arithmatex">\[
g(n) = \dfrac{\varepsilon(n) - \sum_{k\ell = n,~k\neq 1}f(k)g(\ell)}{f(1)}.
\]</div>
</details>
<details class="note">
<summary>证明</summary>
<p>为验证交换律，直接计算可知</p>
<div class="arithmatex">\[
(f\ast g)(n) = \sum_{k\ell=n}f(k)g(\ell) = (g\ast f)(n).
\]</div>
<p>为验证结合律，直接计算可知</p>
<div class="arithmatex">\[
((f\ast g)\ast h)(n) = \sum_{k\ell m = n}f(k)g(\ell)h(m) = (f\ast (g\ast h))(n).
\]</div>
<p>为验证分配律，直接计算可知</p>
<div class="arithmatex">\[
\begin{aligned}
((f+g)\ast h)(n) &amp;= \sum_{k\ell = n}(f(k) + g(k))h(\ell) \\
&amp;= \sum_{k\ell=n}f(k)h(\ell) + \sum_{k\ell=n}g(k)h(\ell) = (f\ast h+g\ast h)(n).
\end{aligned}
\]</div>
<p>为验证 <span class="arithmatex">\(\varepsilon(n)\)</span> 是单位元，直接计算可知</p>
<div class="arithmatex">\[
(f\ast\varepsilon)(n) = \sum_{k\ell = n}f(k)\varepsilon(\ell) = f(n).
\]</div>
<p>第二个等号是因为 <span class="arithmatex">\(\varepsilon(\ell)\)</span> 仅在 <span class="arithmatex">\(\ell=1\)</span> 即 <span class="arithmatex">\(k=n\)</span> 时取得非零值．</p>
<p>最后，需要证明 <span class="arithmatex">\(f^{-1}\)</span> 存在，当且仅当 <span class="arithmatex">\(f(1)\neq 0\)</span>．对于任意 <span class="arithmatex">\(f\)</span>，假设存在 <span class="arithmatex">\(g\)</span> 使得 <span class="arithmatex">\(f\ast g=\varepsilon\)</span>．这意味着</p>
<div class="arithmatex">\[
(f\ast g)(n) = \sum_{k\ell = n}f(k)g(\ell) = \varepsilon(n).
\]</div>
<p>这实际上给出了一系列关于 <span class="arithmatex">\(g(n)\)</span> 取值的方程组，从中可以直接求出 <span class="arithmatex">\(g(n)\)</span>．特别地，当 <span class="arithmatex">\(n=1\)</span> 时，等式变为 <span class="arithmatex">\(f(1)g(1)=1\)</span>，所以 <span class="arithmatex">\(g\)</span> 存在，至少要求 <span class="arithmatex">\(f(1)\neq 0\)</span>．而只要 <span class="arithmatex">\(f(1)\neq 0\)</span>，可以直接解出</p>
<div class="arithmatex">\[
g(n) = \dfrac{\varepsilon(n) - \sum_{k\ell = n,~k\neq 1}f(k)g(\ell)}{f(1)}.
\]</div>
<p>它可以用于递归计算 <span class="arithmatex">\(g(n)\)</span> 的取值．因此，逆元 <span class="arithmatex">\(g\)</span> 存在，当且仅当 <span class="arithmatex">\(f(1)\neq 0\)</span>．</p>
</details>
<p>用抽象代数的语言说，这些代数性质说明，全体数论函数在（逐点）加法运算和 Dirichlet 卷积运算下构成 <a href="../../algebra/basic/#环">交换环</a>，且它的全体可逆元就是那些在 <span class="arithmatex">\(n=1\)</span> 处取非零值的函数．这个环称为 <strong>Dirichlet 环</strong>（Dirichlet ring）．</p>
<p>积性函数是一类特殊的数论函数．它对于 Dirichlet 卷积和 Dirichlet 逆都是封闭的．</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设 <span class="arithmatex">\(f,g\)</span> 是积性函数，那么，<span class="arithmatex">\(f\ast g\)</span> 也是积性函数．而且，逆元 <span class="arithmatex">\(f^{-1}\)</span> 一定存在，它也是积性函数．</p>
</details>
<details class="note">
<summary>证明</summary>
<p>对于第一点，设 <span class="arithmatex">\(h=f\ast g\)</span>，直接验证可知，对于 <span class="arithmatex">\(n_1\perp n_2\)</span>，都有</p>
<div class="arithmatex">\[
\begin{aligned}
h(n_1)h(n_2) &amp;= \left(\sum_{k_1\ell_1=n_1}f(k_1)g(\ell_1)\right)\left(\sum_{k_2\ell_2=n_2}f(k_2)g(\ell_2)\right)\\
&amp;= \sum_{k_1\ell_1=n_1,~k_2\ell_2=n_2}f(k_1)f(k_2)g(\ell_1)g(\ell_2)\\
&amp;= \sum_{k\ell = n_1n_2}f(k)g(\ell) \\
&amp;= h(n_1n_2).
\end{aligned}
\]</div>
<p>其中，第三个等号改变求和顺序的逻辑是：当 <span class="arithmatex">\(k\)</span> 遍历 <span class="arithmatex">\(n_1n_2\)</span> 的因数时，<span class="arithmatex">\(k\)</span> 的素因子可以根据它是 <span class="arithmatex">\(n_1\)</span> 还是 <span class="arithmatex">\(n_2\)</span> 的素因子分为两类，将两类中的素因子（计重复）分别乘起来得到 <span class="arithmatex">\(k_1\)</span> 和 <span class="arithmatex">\(k_2\)</span>，它们将分别遍历 <span class="arithmatex">\(n_1\)</span> 和 <span class="arithmatex">\(n_2\)</span> 的因数；反过来，根据 <span class="arithmatex">\(n_1\)</span> 和 <span class="arithmatex">\(n_2\)</span> 的因数 <span class="arithmatex">\(k_1\)</span> 和 <span class="arithmatex">\(k_2\)</span>，总是可以得到 <span class="arithmatex">\(n_1n_2\)</span> 的因数 <span class="arithmatex">\(k=k_1k_2\)</span>．</p>
<p>对于第二点，设 <span class="arithmatex">\(g=f^{-1}\)</span>，考虑应用数学归纳法．首先，<span class="arithmatex">\(g(1)=1/f(1)=1\)</span>．此时，逆元的递归公式可以写作</p>
<div class="arithmatex">\[
g(n) = \varepsilon(n) - \sum_{k\ell = n,~k\neq 1} f(k)g(\ell).
\]</div>
<p>所以，对于 <span class="arithmatex">\(n_1\perp n_2\)</span> 且 <span class="arithmatex">\(n_1n_2 &gt; 1\)</span>，有</p>
<div class="arithmatex">\[
\begin{aligned}
g(n_1n_2) &amp;= -\sum_{k\ell=n_1n_2,~k\neq 1}f(k)g(\ell) \\
&amp;= -\sum_{k_1\ell_1=n_1,~k_2\ell_2=n_2,~k_1k_2\neq 1}f(k_1)f(k_2)g(\ell_1)g(\ell_2)\\
&amp;= f(1)f(1)g(n_1)g(n_2) - \sum_{k_1\ell_1=n_1,~k_2\ell_2=n_2}f(k_1)f(k_2)g(\ell_1)g(\ell_2)\\
&amp;= g(n_1)g(n_2) - \left(\sum_{k_1\ell_1=n_1}f(k_1)g(\ell_1)\right)\left(\sum_{k_2\ell_2=n_2}f(k_2)g(\ell_2)\right) \\
&amp;= g(n_1)g(n_2) - \varepsilon(n_1)\varepsilon(n_2)\\
&amp;= g(n_1)g(n_2).
\end{aligned}
\]</div>
<p>其中，第二个等号用到了归纳假设，即对于 <span class="arithmatex">\(\ell_1\ell_2 &lt; n_1n_2\)</span> 且 <span class="arithmatex">\(\ell_1\perp\ell_2\)</span>，条件 <span class="arithmatex">\(g(\ell_1\ell_2)=g(\ell_1)g(\ell_2)\)</span> 成立．</p>
</details>
<p>用抽象代数的语言说，全体积性函数在 Dirichlet 卷积运算下构成 Dirichlet 环乘法群的 <a href="../../algebra/group-theory/#子群">子群</a>．</p>
<p>更为特殊的是完全积性函数．</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设 <span class="arithmatex">\(\alpha\)</span> 是完全积性函数，<span class="arithmatex">\(f,g\)</span> 是数论函数．那么，有：</p>
<ol>
<li>分配律：<span class="arithmatex">\((\alpha f)\ast(\alpha g) = \alpha\cdot(f\ast g)\)</span>．</li>
<li>逆元：<span class="arithmatex">\((\alpha f)^{-1}=\alpha f^{-1}\)</span>，只要 <span class="arithmatex">\(f^{-1}\)</span> 存在．</li>
<li>积性函数 <span class="arithmatex">\(f\)</span> 是完全积性函数，当且仅当 <span class="arithmatex">\(f^{-1}=\mu f\)</span>，其中，<span class="arithmatex">\(\mu\)</span> 是 <a href="../mobius/#莫比乌斯函数">莫比乌斯函数</a>．</li>
</ol>
</details>
<details class="note">
<summary>证明</summary>
<p>对于第一条，直接验证可知</p>
<div class="arithmatex">\[
\begin{aligned}
((\alpha f)\ast(\alpha g))(n) &amp;= \sum_{k\ell = n}(\alpha f)(k)(\alpha g)(\ell) \\
&amp;= \sum_{k\ell = n}\alpha(k)f(k)\alpha(\ell)g(\ell) \\
&amp;= \sum_{k\ell = n}\alpha(n)f(k)g(\ell) \\
&amp;= \alpha(n)(f\ast g)(n).
\end{aligned}
\]</div>
<p>其中，第三个等号用到了完全积性函数的性质：<span class="arithmatex">\(\alpha(n)=\alpha(k)\alpha(\ell)\)</span> 对所有 <span class="arithmatex">\(n=k\ell\)</span> 都成立．</p>
<p>对于第二条，利用第一条就有</p>
<div class="arithmatex">\[
(\alpha f)\ast(\alpha f^{-1}) = \alpha(f\ast f^{-1}) = \alpha\varepsilon = \varepsilon.
\]</div>
<p>其中，最后一个等号只利用了 <span class="arithmatex">\(\alpha(1)=1\)</span>．由逆元定义，<span class="arithmatex">\((\alpha f)^{-1}=\alpha f^{-1}\)</span>．</p>
<p>对于第三条，利用第二条和 <span class="arithmatex">\(1^{-1}=\mu\)</span> 可知，如果 <span class="arithmatex">\(f\)</span> 是完全积性函数，那么</p>
<div class="arithmatex">\[
f^{-1} = (1f)^{-1} = 1^{-1}\cdot f = \mu f.
\]</div>
<p>其中，<span class="arithmatex">\(1\)</span> 是常数函数．反过来，如果 <span class="arithmatex">\(f\)</span> 是积性函数且 <span class="arithmatex">\(f^{-1}=\mu f\)</span>，那么只需要证明对于所有素数 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(e\in\mathbf N_+\)</span>，都有 <span class="arithmatex">\(f(p^e)=f(p)^e\)</span> 成立，就能证明 <span class="arithmatex">\(f\)</span> 是完全积性函数．为此，对 <span class="arithmatex">\(e\in\mathbf N_+\)</span> 应用数学归纳法．归纳起点 <span class="arithmatex">\(e=1\)</span> 处命题显然成立．对于任意 <span class="arithmatex">\(e &gt; 1\)</span>，应用逆元递推公式，都有</p>
<div class="arithmatex">\[
\begin{aligned}
f^{-1}(p^e) &amp;= -\sum_{i=1}^{e}f(p^i)f^{-1}(p^{e-i}) \\
&amp;= -\sum_{i=1}^{e}f(p^i)\mu(p^{e-i})f(p^{e-i})\\
&amp;= -f(p^e)f(1)\mu(1) - f(p^{e-1})\mu(p)f(p)\\
&amp;= -f(p^e) + f(p)^e.
\end{aligned}
\]</div>
<p>其中，最后一个等号用到了归纳假设 <span class="arithmatex">\(f(p^{e-1})=f(p)^{e-1}\)</span>．应用 <span class="arithmatex">\(f^{-1}=\mu f\)</span>，就得到</p>
<div class="arithmatex">\[
f^{-1}(p^e) = \mu(p^e)f(p^e) = 0.
\]</div>
<p>代入前式，就得到</p>
<div class="arithmatex">\[
f(p^e) = f(p)^e.
\]</div>
<p>所以，归纳步骤成立．原命题得证．</p>
</details>
<p>用抽象代数的语言说，如果 <span class="arithmatex">\(\alpha\)</span> 是完全积性函数，映射 <span class="arithmatex">\(f\mapsto \alpha f\)</span> 是 Dirichlet 环的 <a href="../../algebra/ring-theory/#理想">自同态</a>．</p>
<h2 id="dirichlet-生成函数">Dirichlet 生成函数<a class="headerlink" href="#dirichlet-生成函数" title="Permanent link"></a></h2>
<p>与 Dirichlet 卷积紧密相关的是 Dirichlet 生成函数．</p>
<p>数论函数 <span class="arithmatex">\(f(n)\)</span>——也就是数列 <span class="arithmatex">\(\{f(n)\}\)</span>——对应的 <strong>Dirichlet 生成函数</strong>（Dirichlet series generating function，DGF）定义为形式 Dirichlet 级数（formal Dirichlet series）：</p>
<div class="arithmatex">\[
F(s) = \sum_{n=1}^{\infty}\dfrac{f(n)}{n^s}.
\]</div>
<p>级数中的 <span class="arithmatex">\(s\)</span> 是形式变元．常见的 Dirichlet 生成函数中，<span class="arithmatex">\(s\)</span> 往往可以看作是复变量，进而讨论 Dirichlet 级数的解析性质，但这超出了算法竞赛的范围．</p>
<p>Dirichlet 生成函数的乘积对应着相应的数论函数的 Dirichlet 卷积：</p>
<details class="note" open="open">
<summary>定理</summary>
<p>对于数论函数 <span class="arithmatex">\(f,g\)</span> 及其 Dirichlet 生成函数 <span class="arithmatex">\(F,G\)</span>，它们的 Dirichlet 卷积 <span class="arithmatex">\(f\ast g\)</span> 的生成函数等于 <span class="arithmatex">\(F\cdot G\)</span>．</p>
</details>
<details class="note">
<summary>证明</summary>
<p>直接验证：</p>
<div class="arithmatex">\[
\begin{aligned}
F(s)G(s) &amp;= \left(\sum_{k=1}^\infty\dfrac{f(k)}{k^s}\right)\left(\sum_{\ell=1}^\infty\dfrac{g(\ell)}{\ell^s}\right)= \sum_{k=1}^\infty\sum_{\ell=1}^\infty\dfrac{f(k)g(\ell)}{(k\ell)^s}\\
&amp;= \sum_{n=1}^{\infty}\dfrac{\sum_{k\ell = n}f(k)g(\ell)}{n^s} = \sum_{n=1}^\infty\dfrac{(f\ast g)(n)}{n^s}.
\end{aligned}
\]</div>
</details>
<p>利用 Dirichlet 卷积和 Dirichlet 生成函数乘积之间的对应关系，可以从 Dirichlet 生成函数的角度理解 Dirichlet 卷积的性质．由于形式 Dirichlet 级数的乘法运算满足交换律、结合律、对加法的分配律，数论函数的 Dirichlet 卷积运算满足同样的代数性质．</p>
<h3 id="euler-乘积">Euler 乘积<a class="headerlink" href="#euler-乘积" title="Permanent link"></a></h3>
<p>积性函数的特殊性同样反映在 Dirichlet 生成函数上．由于整数有 <a href="../basic/#算术基本定理">唯一分解定理</a>，积性函数 <span class="arithmatex">\(f(n)\)</span> 的生成函数 <span class="arithmatex">\(F(s)\)</span> 可写成如下形式：</p>
<div class="arithmatex">\[
\begin{aligned}
F(s) &amp;= \sum_{n=1}^{\infty}\dfrac{f(n)}{n^s} = \sum_{n=1}^{\infty}\prod_{p\in\mathbf P}\dfrac{f(p^{e})}{p^{es}} = \prod_{p\in\mathbf P}\sum_{e=0}^{\infty}\dfrac{f(p^e)}{p^{es}}\\
&amp;= \prod_{p\in\mathbf P}\left(1 + \dfrac{f(p)}{p^s} + \dfrac{f(p^2)}{p^{2s}} + \dfrac{f(p^3)}{p^{3s}} + \cdots\right).
\end{aligned}
\]</div>
<p>这意味着，<span class="arithmatex">\(F(s)\)</span> 可以分解为若干 <span class="arithmatex">\(F_p(s)\)</span> 的乘积，且每个 <span class="arithmatex">\(F_p(s)\)</span> 对应的数论函数都只在 <span class="arithmatex">\(p\)</span> 的幂次处可能取非零值．这一无穷乘积也称为 <strong>Euler 乘积</strong>（Euler product）．如果 <span class="arithmatex">\(F(s)\)</span> 和 <span class="arithmatex">\(G(s)\)</span> 都能分解成类似的形式，那么它们的乘积同样如此；将这一观察对应到数论函数上，就是积性函数的 Dirichlet 卷积仍然是积性函数．</p>
<p>进一步地，如果 <span class="arithmatex">\(f(n)\)</span> 还是完全积性函数，那么 <span class="arithmatex">\(f(p^e)=f(p)^e\)</span>，上式可以继续简化：</p>
<div class="arithmatex">\[
F(s) = \prod_{p\in\mathbf P}\sum_{e=0}^{\infty}\dfrac{f(p)^e}{p^{es}} = \prod_{p\in\mathbf P}\left(1-\dfrac{f(p)}{p^s}\right)^{-1}.
\]</div>
<p>与积性函数不同，完全积性函数的 Dirichlet 生成函数的形式在乘法运算下并不具有封闭性，因此，完全积性函数的 Dirichlet 卷积和 Dirichlet 逆都未必是完全积性函数，但一定是积性函数．</p>
<details class="example" open="open">
<summary>例子</summary>
<ol>
<li>
<p>单位函数 <span class="arithmatex">\(\varepsilon(n)\)</span> 是完全积性函数．它的 Dirichlet 生成函数是关于不定元 <span class="arithmatex">\(s\)</span> 的常值函数</p>
<div class="arithmatex">\[
E(s) = \sum_{n=1}^{\infty}\dfrac{\varepsilon(n)}{n^s} = 1.
\]</div>
</li>
<li>
<p>常数函数 <span class="arithmatex">\(1(n)\)</span> 是完全积性函数．它的 Dirichlet 生成函数是 Riemann 函数</p>
<div class="arithmatex">\[
I(s) = \sum_{n=1}^{\infty}\dfrac{1}{n^s} = \prod_{p\in\mathbf P}\dfrac{1}{1-p^{-s}} = \zeta(s).
\]</div>
</li>
<li>
<p>莫比乌斯函数 <span class="arithmatex">\(\mu(n)\)</span> 是常数函数的 Dirichlet 逆．它的 Dirichlet 生成函数是 <span class="arithmatex">\(\zeta(s)\)</span> 的倒数：</p>
<div class="arithmatex">\[
M(s) = \sum_{n=1}^{\infty}\dfrac{\mu(n)}{n^s} = \prod_{p\in\mathbf P}(1-p^{-s}) = \dfrac{1}{\zeta(s)}.
\]</div>
</li>
<li>
<p>幂函数 <span class="arithmatex">\(\operatorname{id}_k(n)=n^k\)</span> 是完全积性函数．特别地，当 <span class="arithmatex">\(k=0\)</span> 时，它就是常数函数；当 <span class="arithmatex">\(k=1\)</span> 时，它就是恒等函数．它的 Dirichlet 生成函数是</p>
<div class="arithmatex">\[
I_k(s) = \sum_{n=1}^{\infty}\dfrac{n^k}{n^s} = \prod_{p\in\mathbf P}\dfrac{1}{1-p^{k-s}} = \zeta(s-k).
\]</div>
</li>
<li>
<p>欧拉函数 <span class="arithmatex">\(\varphi(n)\)</span> 是积性函数．它的 Dirichlet 生成函数是</p>
<div class="arithmatex">\[
\begin{aligned}
\Phi(s) &amp;= \prod_{p\in\mathbf P}\left(1+\dfrac{p-1}{p^s} + \dfrac{p(p-1)}{p^{2s}} + \dfrac{p^2(p-1)}{p^{3s}}+\cdots\right)\\
&amp;= \prod_{p\in\mathbf P}\left(\dfrac{1}{1-p^{1-s}}-\dfrac{1}{p^s}\dfrac{1}{1-p^{1-s}}\right) = \prod_{p\in\mathbf P}\dfrac{1-p^{-s}}{1-p^{1-s}} = \dfrac{\zeta(s-1)}{\zeta(s)}.
\end{aligned}
\]</div>
<p>结合幂函数的 Dirichlet 函数表达式，就得到 <span class="arithmatex">\(\mathrm{id} = \varphi\ast 1\)</span>．</p>
</li>
<li>
<p>约数函数 <span class="arithmatex">\(\sigma_k(n)=\sum_{d\mid n}d^k\)</span> 是积性函数．它的 Dirichlet 生成函数是</p>
<div class="arithmatex">\[
\begin{aligned}
\Sigma_k(s) &amp;= \prod_{p\in\mathbf P}\left(1+\dfrac{1+p^k}{p^s}+\dfrac{1+p^k+p^{2k}}{p^{2s}}+\dfrac{1+p^k+p^{2k}+p^{3k}}{p^{3s}}+\cdots\right) \\
&amp;= \prod_{p\in\mathbf P}\dfrac{1}{1-p^k}\left((1-p^k)+\dfrac{1-p^{2k}}{p^s}+\dfrac{1-p^{3k}}{p^{2s}}+\dfrac{1-p^{4k}}{p^{3k}}+\cdots\right)\\
&amp;= \prod_{p\in\mathbf P}\dfrac{1}{1-p^k}\left(\dfrac{1}{1-p^{-s}} - \dfrac{p^k}{1-p^{k-s}}\right)\\
&amp;= \prod_{p\in\mathbf P}\dfrac{1}{(1-p^{-s})(1-p^{k-s})} = \zeta(s-k)\zeta(s).
\end{aligned}
\]</div>
<p>结合幂函数的 Dirichlet 表达式，就得到 <span class="arithmatex">\(\sigma_k = \mathrm{id}_k\ast 1\)</span>．这正是 <span class="arithmatex">\(\sigma_k\)</span> 的定义式．</p>
</li>
<li>
<p>无平方因子数的指示函数 <span class="arithmatex">\(u(n)=|\mu(n)|\)</span> 是积性函数．它的 Dirichlet 生成函数是</p>
<div class="arithmatex">\[
U(s) = \prod_{p\in\mathbf P}(1+p^{-s}) = \prod_{p\in\mathbf P}\dfrac{1-p^{-2s}}{1-p^{-s}} = \dfrac{\zeta(s)}{\zeta(2s)}.
\]</div>
</li>
</ol>
</details>
<h3 id="应用">应用<a class="headerlink" href="#应用" title="Permanent link"></a></h3>
<p>Dirichlet 生成函数可以用于将积性函数表示为 Dirichlet 卷积．</p>
<p>例如在杜教筛的过程中，要计算积性函数 <span class="arithmatex">\(f\)</span> 的前缀和，需要找到另一个积性函数 <span class="arithmatex">\(g\)</span> 使得 <span class="arithmatex">\(f\ast g\)</span> 和 <span class="arithmatex">\(g\)</span> 都可以快速求前缀和．可以利用 Dirichlet 生成函数推导这一过程．</p>
<p>以杜教筛一节的例题 <a href="../du/#问题二">Luogu P3768 简单的数学题</a> 为例，需要对 <span class="arithmatex">\(f(n)=n^2\varphi(n)\)</span> 构造满足上述条件的数论函数 <span class="arithmatex">\(g(n)\)</span>．由于 <span class="arithmatex">\(f\)</span> 是积性函数，它的 Dirichlet 生成函数为</p>
<div class="arithmatex">\[
F(s) = \prod_{p\in\mathbf P}\left(1 + \sum_{k=1}^{\infty}\dfrac{p^{3k-1}(p-1)}{p^{ks}}\right) = \prod_{p\in\mathbf P}\dfrac{1-p^{2-s}}{1-p^{3-s}} = \dfrac{\zeta(s-3)}{\zeta(s-2)}.
\]</div>
<p>对比幂函数的 Dirichlet 生成函数可知，只要取 <span class="arithmatex">\(g = \mathrm{id}_2\)</span>，就有 <span class="arithmatex">\(f \ast g = \mathrm{id}_3\)</span>．两者都是可以快速计算前缀和的．</p>
<h2 id="dirichlet-卷积的计算">Dirichlet 卷积的计算<a class="headerlink" href="#dirichlet-卷积的计算" title="Permanent link"></a></h2>
<p>本节讨论 Dirichlet 卷积的计算问题，即给定序列 <span class="arithmatex">\(\{f(k)\}_{k=1}^n\)</span> 和 <span class="arithmatex">\(\{g(k)\}_{k=1}^n\)</span>，求解 Dirichlet 卷积 <span class="arithmatex">\(h=f\ast g\)</span> 的前若干项 <span class="arithmatex">\(\{h(k)\}_{k=1}^n\)</span> 的问题．根据涉及到的函数性质，算法的复杂度也略有不同．</p>
<h3 id="一般情形">一般情形<a class="headerlink" href="#一般情形" title="Permanent link"></a></h3>
<p>如果 <span class="arithmatex">\(f,g,h\)</span> 都没有特殊性质，那么 Dirichlet 卷积的计算只能利用其定义：</p>
<div class="arithmatex">\[
h(n) = \sum_{k\ell = n}f(k)g(\ell).
\]</div>
<p>枚举 <span class="arithmatex">\(k\)</span> 和 <span class="arithmatex">\(\ell\)</span>，将贡献 <span class="arithmatex">\(f(k)g(\ell)\)</span> 累加到 <span class="arithmatex">\(h(k\ell)\)</span> 上即可．枚举复杂度为</p>
<div class="arithmatex">\[
O\left(\sum_{k=1}^{n}\dfrac{n}{k}\right) = O(n\log n).
\]</div>
<p>参考实现如下：</p>
<details class="example" open="open">
<summary>参考实现</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-</span><span class="mi">-8</span><span class="o">&lt;--</span><span class="w"> </span><span class="s">&quot;docs/math/code/dirichlet/dirichlet-1.cpp:core&quot;</span>
</code></pre></div></td></tr></table></div>
</details>
<h3 id="与积性函数卷积的情形">与积性函数卷积的情形<a class="headerlink" href="#与积性函数卷积的情形" title="Permanent link"></a></h3>
<p>如果 <span class="arithmatex">\(g\)</span> 是积性函数，那么可以利用 Euler 乘积加速 Dirichlet 卷积的计算．计算 <span class="arithmatex">\(h\)</span> 相当于计算它的 Dirichlet 生成函数 <span class="arithmatex">\(H\)</span> 中各项的系数．由于</p>
<div class="arithmatex">\[
H(s) = F(s)G(s) = F(s)\prod_{p\in\mathbf P}G_p(s).
\]</div>
<p>其中，<span class="arithmatex">\(G_p(s)\)</span> 是 <span class="arithmatex">\(G(s)\)</span> 的 Euler 乘积分解中的因式，它只包含 <span class="arithmatex">\(p\)</span> 的幂次处的系数：</p>
<div class="arithmatex">\[
G_p(s) = \sum_{p^k\le n}\dfrac{f(p^k)}{p^{ks}} = 1 + \dfrac{f(p)}{p^s} + \dfrac{f(p^2)}{p^{2s}} + \cdots.
\]</div>
<p>那么，从 <span class="arithmatex">\(F(s)\)</span> 开始，遍历所有不超过 <span class="arithmatex">\(n\)</span> 的素数 <span class="arithmatex">\(p\)</span>，将 <span class="arithmatex">\(G_p(s)\)</span> 逐一乘上去，同样可以得到最终结果 <span class="arithmatex">\(H(s)\)</span>．将 <span class="arithmatex">\(G_p(s)\)</span> 乘上去时，直接应用一般情形中的暴力枚举算法即可．总枚举次数</p>
<div class="arithmatex">\[
\sum_{p\in\mathbf P,~p\le n}\sum_{k=1}^{\infty}\left\lfloor\dfrac{n}{p^k}\right\rfloor \le \sum_{p\in\mathbf P,~p\le n}\dfrac{n}{p-1} \le \sum_{p\in\mathbf P,~p\le n}\dfrac{2n}{p} \in O(n\log\log n).
\]</div>
<p>最后一步复杂度的估计与 <a href="../sieve/#埃拉托斯特尼筛法">Eratosthenes 筛法</a> 复杂度的证明一致．所以，本算法的时间复杂度为 <span class="arithmatex">\(O(n\log\log n)\)</span>．</p>
<p>参考实现如下：</p>
<details class="example" open="open">
<summary>参考实现</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-</span><span class="mi">-8</span><span class="o">&lt;--</span><span class="w"> </span><span class="s">&quot;docs/math/code/dirichlet/dirichlet-2.cpp:core&quot;</span>
</code></pre></div></td></tr></table></div>
</details>
<p>特别地，当积性函数 <span class="arithmatex">\(g\)</span> 是完全积性函数或其 Dirichlet 逆时，例如当 <span class="arithmatex">\(g = 1\)</span> 或 <span class="arithmatex">\(g = \mu\)</span> 时，那么算法可以进一步简化。此时，Dirichlet 卷积 <span class="arithmatex">\(h = f\ast g\)</span> 的计算可以采用常数更小的 <a href="../mobius/#dirichlet-前缀和">Dirichlet 前缀和/差分</a> 算法，但是算法时间复杂度仍为 <span class="arithmatex">\(O(n\log\log n)\)</span>。</p>
<h3 id="结果为积性函数的情形">结果为积性函数的情形<a class="headerlink" href="#结果为积性函数的情形" title="Permanent link"></a></h3>
<p>最后，考虑 <span class="arithmatex">\(h\)</span> 是积性函数的情形．特别地，当 <span class="arithmatex">\(f,g\)</span> 都是积性函数时，<span class="arithmatex">\(h=f \ast g\)</span> 就是积性函数．要计算 <span class="arithmatex">\(h\)</span>，只需要确定它在素数幂处的取值，就可以通过 <a href="../sieve/#线性筛法">线性筛</a> 在 <span class="arithmatex">\(O(n)\)</span> 时间内计算．而对于素数幂 <span class="arithmatex">\(p^e\)</span> 处的取值 <span class="arithmatex">\(h(p^e)\)</span> 直接暴力计算即可：</p>
<div class="arithmatex">\[
h(p^e) = \sum_{i=0}^e f(p^i)g(p^{e-i}).
\]</div>
<p>这些暴力计算需要的枚举次数为</p>
<div class="arithmatex">\[
\begin{aligned}
\sum_{p\in\mathbf P,~p\le n}\sum_{e=1}^{\lfloor\log_p n\rfloor}(e+1) &amp;\le \sum_{p\in\mathbf P,~p\le\sqrt{n}}\lfloor\log_p n\rfloor^2 + \sum_{p\in\mathbf P,~\sqrt{n} &lt; p\le n}1 \\
&amp;\le \sqrt{n}(\log_2 n)^2 + n \in O(n).
\end{aligned}
\]</div>
<p>因此，这一算法的总时间复杂度为 <span class="arithmatex">\(O(n)\)</span>．</p>
<p>参考实现如下：</p>
<details class="example" open="open">
<summary>参考实现</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">-</span><span class="mi">-8</span><span class="o">&lt;--</span><span class="w"> </span><span class="s">&quot;docs/math/code/dirichlet/dirichlet-3.cpp:core&quot;</span>
</code></pre></div></td></tr></table></div>
</details>
<h2 id="参考资料与注释">参考资料与注释<a class="headerlink" href="#参考资料与注释" title="Permanent link"></a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Dirichlet_convolution">Dirichlet convolution - Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Dirichlet_series">Dirichlet series - Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Euler_product">Euler product - Wikipedia</a></li>
<li><a href="https://maspypy.com/dirichlet-%e7%a9%8d%e3%81%a8%e3%80%81%e6%95%b0%e8%ab%96%e9%96%a2%e6%95%b0%e3%81%ae%e7%b4%af%e7%a9%8d%e5%92%8c">Dirichlet 積と、数論関数の累積和 by maspy</a></li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.expand", "navigation.tabs"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../_static/js/math-csr.js?math-csr"></script>
      
        <script src="../../../assets/vendor/mathjax/tex-mml-chtml.js?math-csr"></script>
      
    
  </body>
</html>